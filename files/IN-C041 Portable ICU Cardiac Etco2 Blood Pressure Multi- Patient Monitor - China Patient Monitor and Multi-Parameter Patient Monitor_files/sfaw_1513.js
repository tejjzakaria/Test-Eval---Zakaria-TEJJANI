function _typeof(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function e(t){return typeof t}}else{_typeof=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return _typeof(e)}!function(e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))?module.exports=e():e()}(function(){function BatchSend(){this.sendingData=0}try{var sd={};sd.modules={};var _=sd._={};"object"!=(typeof JSON==="undefined"?"undefined":_typeof(JSON))&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,s,a,n,i,o=gap,d=t[e];switch(d&&"object"==_typeof(d)&&"function"==typeof d.toJSON&&(d=d.toJSON(e)),"function"==typeof rep&&(d=rep.call(t,e,d)),_typeof(d)){case"string":return quote(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(d)){for(n=d.length,r=0;r<n;r+=1){i[r]=str(r,d)||"null"}return a=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+o+"]":"["+i.join(",")+"]",gap=o,a}if(rep&&"object"==_typeof(rep))for(n=rep.length,r=0;r<n;r+=1){"string"==typeof rep[r]&&(s=rep[r],a=str(s,d),a&&i.push(quote(s)+(gap?": ":":")+a))}else for(s in d){Object.prototype.hasOwnProperty.call(d,s)&&(a=str(s,d),a&&i.push(quote(s)+(gap?": ":":")+a))}return a=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+o+"}":"{"+i.join(",")+"}",gap=o,a}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var s;if(gap="",indent="","number"==typeof r)for(s=0;s<r;s+=1){indent+=" "}else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=_typeof(t)||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,s,a=e[t];if(a&&"object"==_typeof(a))for(r in a){Object.prototype.hasOwnProperty.call(a,r)&&(s=walk(a,r),void 0!==s?a[r]=s:delete a[r])}return reviver.call(e,t,a)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var e=Array.prototype,t=Function.prototype,r=Object.prototype,s=e.slice,a=r.toString,i=r.hasOwnProperty,o=(t.bind,e.forEach),n=(e.indexOf,Array.isArray),d={},c=_.each=function(e,t,r){if(null==e)return!1;if(o&&e.forEach===o)e.forEach(t,r);else if(e.length===+e.length){for(var s=0,a=e.length;s<a;s++){if(s in e&&t.call(r,e[s],s,e)===d)return!1}}else for(var n in e){if(i.call(e,n)&&t.call(r,e[n],n,e)===d)return!1}};_.extend=function(r){return c(s.call(arguments,1),function(e){for(var t in e){void 0!==e[t]&&(r[t]=e[t])}}),r},_.extend2Lev=function(r){return c(s.call(arguments,1),function(e){for(var t in e){void 0!==e[t]&&(_.isObject(e[t])&&_.isObject(r[t])?_.extend(r[t],e[t]):r[t]=e[t])}}),r},_.coverExtend=function(r){return c(s.call(arguments,1),function(e){for(var t in e){void 0!==e[t]&&void 0===r[t]&&(r[t]=e[t])}}),r},_.isArray=n||function(e){return"[object Array]"===a.call(e)},_.isFunction=function(e){if(!e)return!1;try{return/^\s*\bfunction\b/.test(e)}catch(e){return!1}},_.isArguments=function(e){return!(!e||!i.call(e,"callee"))},_.toArray=function(e){return e?e.toArray?e.toArray():_.isArray(e)?s.call(e):_.isArguments(e)?s.call(e):_.values(e):[]},_.values=function(e){var t=[];return null==e?t:(c(e,function(e){t[t.length]=e}),t)},_.indexOf=function(e,t){var r=e.indexOf;if(r)return r.call(e,t);for(var s=0;s<e.length;s++){if(t===e[s])return s}return-1},_.hasAttribute=function(e,t){return e.hasAttribute?e.hasAttribute(t):!(!e.attributes[t]||!e.attributes[t].specified)},_.filter=function(e,t,r){var s=Object.prototype.hasOwnProperty;if(e.filter)return e.filter(t);for(var a=[],n=0;n<e.length;n++){if(s.call(e,n)){var i=e[n];t.call(r,i,n,e)&&a.push(i)}}return a},_.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},_.trim=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},_.isObject=function(e){return null!=e&&"[object Object]"==a.call(e)},_.isEmptyObject=function(e){if(_.isObject(e)){for(var t in e){if(i.call(e,t))return!1}return!0}return!1},_.isUndefined=function(e){return void 0===e},_.isString=function(e){return"[object String]"==a.call(e)},_.isDate=function(e){return"[object Date]"==a.call(e)},_.isBoolean=function(e){return"[object Boolean]"==a.call(e)},_.isNumber=function(e){return"[object Number]"==a.call(e)&&/[\d\.]+/.test(String(e))},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},_.safeJSONParse=function(e){var t=null;try{t=JSON.parse(e)}catch(e){return!1}return t},_.decodeURIComponent=function(t){var r=t;try{r=decodeURIComponent(t)}catch(e){r=t}return r},_.encodeDates=function(r){return _.each(r,function(e,t){_.isDate(e)?r[t]=_.formatDate(e):_.isObject(e)&&(r[t]=_.encodeDates(e))}),r},_.mediaQueriesSupported=function(){return"undefined"!=typeof window.matchMedia||"undefined"!=typeof window.msMatchMedia},_.getScreenOrientation=function(){var e=screen.msOrientation||screen.mozOrientation||(screen.orientation||{}).type,t="未取到值";if(e)t=e.indexOf("landscape")>-1?"landscape":"portrait";else if(_.mediaQueriesSupported()){var r=window.matchMedia||window.msMatchMedia;r("(orientation: landscape)").matches?t="landscape":r("(orientation: portrait)").matches&&(t="portrait")}return t},_.now=Date.now||function(){return(new Date).getTime()},_.throttle=function(r,s,a){var n,i,o,d=null,c=0;a||(a={});var u=function e(){c=a.leading===!1?0:_.now(),d=null,o=r.apply(n,i),d||(n=i=null)};return function(){var e=_.now();c||a.leading!==!1||(c=e);var t=s-(e-c);return n=this,i=arguments,t<=0||t>s?(d&&(clearTimeout(d),d=null),c=e,o=r.apply(n,i),d||(n=i=null)):d||a.trailing===!1||(d=setTimeout(u,t)),o}},_.hashCode=function(e){if("string"!=typeof e)return 0;var t=0,r=null;if(0==e.length)return t;for(var s=0;s<e.length;s++){r=e.charCodeAt(s),t=(t<<5)-t+r,t&=t}return t},_.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())},_.searchObjDate=function(r){_.isObject(r)&&_.each(r,function(e,t){_.isObject(e)?_.searchObjDate(r[t]):_.isDate(e)&&(r[t]=_.formatDate(e))})},_.searchZZAppStyle=function(e){"undefined"!=typeof e.properties.$project&&(e.project=e.properties.$project,delete e.properties.$project),"undefined"!=typeof e.properties.$token&&(e.token=e.properties.$token,delete e.properties.$token)},_.formatJsonString=function(t){try{return JSON.stringify(t,null,"  ")}catch(e){return JSON.stringify(t)}},_.formatString=function(e){return e.length>sd.para.max_string_length?(sd.log("字符串长度超过限制，已经做截取--"+e),e.slice(0,sd.para.max_string_length)):e},_.searchObjString=function(r){_.isObject(r)&&_.each(r,function(e,t){_.isObject(e)?_.searchObjString(r[t]):_.isString(e)&&(r[t]=_.formatString(e))})},_.parseSuperProperties=function(r){_.isObject(r)&&(_.each(r,function(e,t){if(_.isFunction(e))try{r[t]=e(),_.isFunction(r[t])&&(sd.log("您的属性- "+t+" 格式不满足要求，我们已经将其删除"),delete r[t])}catch(e){delete r[t],sd.log("您的属性- "+t+" 抛出了异常，我们已经将其删除")}}),_.strip_sa_properties(r))},_.filterReservedProperties=function(r){var e=["distinct_id","user_id","id","date","datetime","event","events","first_id","original_id","device_id","properties","second_id","time","users"];_.isObject(r)&&_.each(e,function(e,t){e in r&&(t<3?(delete r[e],sd.log("您的属性- "+e+"是保留字段，我们已经将其删除")):sd.log("您的属性- "+e+"是保留字段，请避免其作为属性名"))})},_.searchConfigData=function(e){if("object"==_typeof(e)&&e.$option){var t=e.$option;return delete e.$option,t}return{}},_.unique=function(e){for(var t,r=[],s={},a=0;a<e.length;a++){t=e[a],t in s||(s[t]=!0,r.push(t))}return r},_.strip_sa_properties=function(e){return _.isObject(e)?(_.each(e,function(t,r){if(_.isArray(t)){var s=[];_.each(t,function(e){_.isString(e)?s.push(e):sd.log("您的数据-",r,t,"的数组里的值必须是字符串,已经将其删除")}),0!==s.length?e[r]=s:(delete e[r],sd.log("已经删除空的数组"))}_.isString(t)||_.isNumber(t)||_.isDate(t)||_.isBoolean(t)||_.isArray(t)||_.isFunction(t)||"$option"===r||(sd.log("您的数据-",r,t,"-格式不满足要求，我们已经将其删除"),delete e[r])}),e):e},_.strip_empty_properties=function(e){var r={};return _.each(e,function(e,t){null!=e&&(r[t]=e)}),r},_.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,r,s,a="",n=0;for(t=r=0,n=e.length,s=0;s<n;s++){var i=e.charCodeAt(s),o=null;i<128?r++:o=i>127&&i<2048?String.fromCharCode(i>>6|192,63&i|128):String.fromCharCode(i>>12|224,i>>6&63|128,63&i|128),null!==o&&(r>t&&(a+=e.substring(t,r)),a+=o,t=r=s+1)}return r>t&&(a+=e.substring(t,e.length)),a},_.base64Encode=function(e){if("function"==typeof btoa)return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}));e=String(e);var t,r,s,a,n,i,o,d,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=0,p=0,l="",f=[];if(!e)return e;e=_.utf8Encode(e);do{t=e.charCodeAt(u++),r=e.charCodeAt(u++),s=e.charCodeAt(u++),d=t<<16|r<<8|s,a=d>>18&63,n=d>>12&63,i=d>>6&63,o=63&d,f[p++]=c.charAt(a)+c.charAt(n)+c.charAt(i)+c.charAt(o)}while(u<e.length);switch(l=f.join(""),e.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l},_.UUID=function(){var r=function e(){for(var e=1*new Date,t=0;e==1*new Date;){t++}return e.toString(16)+t.toString(16)},s=function e(){return Math.random().toString(16).replace(".","")},a=function e(t){function r(e,t){var r,s=0;for(r=0;r<t.length;r++){s|=n[r]<<8*r}return e^s}var e,s,a=navigator.userAgent,n=[],i=0;for(e=0;e<a.length;e++){s=a.charCodeAt(e),n.unshift(255&s),n.length>=4&&(i=r(i,n),n=[])}return n.length>0&&(i=r(i,n)),i.toString(16)};return function(){var e=String(screen.height*screen.width);e=e&&/\d{5,}/.test(e)?e.toString(16):String(31242*Math.random()).replace(".","").slice(0,8);var t=r()+"-"+s()+"-"+a()+"-"+e+"-"+r();return t?t:(String(Math.random())+String(Math.random())+String(Math.random())).slice(2,15)}}(),_.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=_.decodeURIComponent(e);var r="[\\?&]"+t+"=([^&#]*)",s=new RegExp(r),a=s.exec(e);return null===a||a&&"string"!=typeof a[1]&&a[1].length?"":_.decodeURIComponent(a[1])},_.urlParse=function(e){var t=function e(t){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Path:8,URL:0,QueryString:9,Fragment:10},this._values={},this._regex=null,this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/,"undefined"!=typeof t&&this._parse(t)};return t.prototype.setUrl=function(e){this._parse(e)},t.prototype._initValues=function(){for(var e in this._fields){this._values[e]=""}},t.prototype.addQueryString=function(e){if("object"!=_typeof(e))return!1;var t=this._values.QueryString||"";for(var r in e){t=new RegExp(r+"[^&]+").test(t)?t.replace(new RegExp(r+"[^&]+"),r+"="+e[r]):"&"===t.slice(-1)?t+r+"="+e[r]:""===t?r+"="+e[r]:t+"&"+r+"="+e[r]}this._values.QueryString=t},t.prototype.getUrl=function(){var e="";return e+=this._values.Origin,e+=this._values.Port?":"+this._values.Port:"",e+=this._values.Path,e+=this._values.QueryString?"?"+this._values.QueryString:"",e+=this._values.Fragment?"#"+this._values.Fragment:""},t.prototype.getUrl=function(){var e="";return e+=this._values.Origin,e+=this._values.Port?":"+this._values.Port:"",e+=this._values.Path,e+=this._values.QueryString?"?"+this._values.QueryString:""},t.prototype._parse=function(e){this._initValues();var t=this._regex.exec(e);if(!t)throw"DPURLParser::_parse -> Invalid URL";for(var r in this._fields){"undefined"!=typeof t[this._fields[r]]&&(this._values[r]=t[this._fields[r]])}this._values.Hostname=this._values.Host.replace(/:\d+$/,""),this._values.Origin=this._values.Protocol+"://"+this._values.Hostname},new t(e)},_.addEvent=function(){function d(e){return e&&(e.preventDefault=d.preventDefault,e.stopPropagation=d.stopPropagation,e._getPath=d._getPath),e}function o(n,i,o){var e=function e(t){if(t=t||d(window.event)){t.target=t.srcElement;var r,s,a=!0;return"function"==typeof o&&(r=o(t)),s=i.call(n,t),!1!==r&&!1!==s||(a=!1),a}};return e}d._getPath=function(){var r=this,e=function e(){try{var e=r.target,t=[e];if(null===e||null===e.parentElement)return[];for(;null!==e.parentElement;){e=e.parentElement,t.unshift(e)}return t}catch(e){return[]}};return this.path||this.composedPath&&this.composedPath()||e()},d.preventDefault=function(){this.returnValue=!1},d.stopPropagation=function(){this.cancelBubble=!0};var e=function e(t,r,s){var a=!(!_.isObject(sd.para.heatmap)||!sd.para.heatmap.useCapture);if(_.isObject(sd.para.heatmap)&&"undefined"==typeof sd.para.heatmap.useCapture&&"click"===r&&(a=!0),t&&t.addEventListener)t.addEventListener(r,function(e){e._getPath=d._getPath,s.call(this,e)},a);else{var n="on"+r,i=t[n];t[n]=o(t,s,i)}};e.apply(null,arguments)},_.addHashEvent=function(e){var t="pushState"in window.history?"popstate":"hashchange";_.addEvent(window,t,e)},_.addSinglePageEvent=function(e){var t=location.href,r=window.history.pushState,s=window.history.replaceState;window.history.pushState=function(){r.apply(window.history,arguments),e(t),t=location.href},window.history.replaceState=function(){s.apply(window.history,arguments),e(t),t=location.href};var a=r?"popstate":"hashchange";_.addEvent(window,a,function(){e(t),t=location.href})},_.cookie={get:function e(t){for(var r=t+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){for(var n=s[a];" "==n.charAt(0);){n=n.substring(1,n.length)}if(0==n.indexOf(r))return _.decodeURIComponent(n.substring(r.length,n.length))}return null},set:function e(t,r,s,a,n){a="undefined"==typeof a?sd.para.cross_subdomain:a;var i="",o="",d="";if(s=null==s?73e3:s,a){var c=_.getCurrentDomain(location.href);"url解析失败"===c&&(c=""),i=c?"; domain="+c:""}if(0!==s){var u=new Date;"s"===String(s).slice(-1)?u.setTime(u.getTime()+1e3*Number(String(s).slice(0,-1))):u.setTime(u.getTime()+24*s*60*60*1e3),o="; expires="+u.toGMTString()}n&&(d="; secure"),document.cookie=t+"="+encodeURIComponent(r)+o+"; path=/"+i+d},remove:function e(t,r){r="undefined"==typeof r?sd.para.cross_subdomain:r,_.cookie.set(t,"",-1,r)},getCookieName:function e(t,r){var s="";if(r=r||location.href,sd.para.cross_subdomain===!1){try{s=_.URL(r).hostname}catch(e){sd.log(e)}s="string"==typeof s&&""!==s?"sajssdk_2015_"+t+"_"+s.replace(/\./g,"_"):"sajssdk_2015_root_"+t}else s="sajssdk_2015_cross_"+t;return s},getNewUser:function e(){var t="new_user";return null!==this.get("sensorsdata_is_new_user")||null!==this.get(this.getCookieName(t))}},_.getElementContent=function(e,t){var r="",s="";return e.textContent?r=_.trim(e.textContent):e.innerText&&(r=_.trim(e.innerText)),r&&(r=r.replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)),s=r||"","input"!==t&&"INPUT"!==t||("button"===e.type||"submit"===e.type?s=e.value||"":sd.para.heatmap&&"function"==typeof sd.para.heatmap.collect_input&&sd.para.heatmap.collect_input(e)&&(s=e.value||"")),s},_.getEleInfo=function(e){if(!e.target)return!1;var t=e.target,r=t.tagName.toLowerCase(),s={};return s.$element_type=r,s.$element_name=t.getAttribute("name"),s.$element_id=t.getAttribute("id"),s.$element_class_name="string"==typeof t.className?t.className:null,s.$element_target_url=t.getAttribute("href"),s.$element_content=_.getElementContent(t,r),s=_.strip_empty_properties(s),s.$url=location.href,s.$url_path=location.pathname,s.$title=document.title,s.$viewport_width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,s},_.localStorage={get:function e(t){return window.localStorage.getItem(t)},parse:function e(t){var r;try{r=JSON.parse(_.localStorage.get(t))||null}catch(e){sd.log(e)}return r},set:function e(t,r){window.localStorage.setItem(t,r)},remove:function e(t){window.localStorage.removeItem(t)},isSupport:function e(){var t=!0;try{var r="__sensorsdatasupport__",s="testIsSupportStorage";_.localStorage.set(r,s),_.localStorage.get(r)!==s&&(t=!1),_.localStorage.remove(r)}catch(e){t=!1}return t}},_.sessionStorage={isSupport:function e(){var t=!0,r="__sensorsdatasupport__",s="testIsSupportStorage";try{sessionStorage&&sessionStorage.setItem?(sessionStorage.setItem(r,s),sessionStorage.removeItem(r,s),t=!0):t=!1}catch(e){t=!1}return t}},_.isSupportCors=function(){return"undefined"!=typeof window.XMLHttpRequest&&("withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest)},_.xhr=function(e){if(e)return"undefined"!=typeof window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:null;if("undefined"!=typeof window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){sd.log(e)}}},_.ajax=function(t){function e(e){if(!e)return"";try{return JSON.parse(e)}catch(e){return{}}}t.timeout=t.timeout||2e4,t.credentials="undefined"==typeof t.credentials||t.credentials;var r=_.xhr(t.cors);if(!r)return!1;t.type||(t.type=t.data?"POST":"GET"),t=_.extend({success:function e(){},error:function e(){}},t);try{"object"==_typeof(r)&&"timeout"in r?r.timeout=t.timeout:setTimeout(function(){r.abort()},t.timeout+500)}catch(e){try{setTimeout(function(){r.abort()},t.timeout+500)}catch(e){sd.log(e)}}r.onreadystatechange=function(){try{4==r.readyState&&(r.status>=200&&r.status<300||304==r.status?t.success(e(r.responseText)):t.error(e(r.responseText),r.status),r.onreadystatechange=null,r.onload=null)}catch(e){r.onreadystatechange=null,r.onload=null}},r.open(t.type,t.url,!0);try{if(t.credentials&&(r.withCredentials=!0),_.isObject(t.header))for(var s in t.header){r.setRequestHeader(s,t.header[s])}t.data&&(t.cors||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),"application/json"===t.contentType?r.setRequestHeader("Content-type","application/json; charset=UTF-8"):r.setRequestHeader("Content-type","application/x-www-form-urlencoded"))}catch(e){sd.log(e)}r.send(t.data||null)},_.loadScript=function(e){e=_.extend({success:function e(){},error:function e(){},appendCall:function e(t){document.getElementsByTagName("head")[0].appendChild(t)}},e);var t=null;"css"===e.type&&(t=document.createElement("link"),t.rel="stylesheet",t.href=e.url),"js"===e.type&&(t=document.createElement("script"),t.async="async",t.setAttribute("charset","UTF-8"),t.src=e.url,t.type="text/javascript"),t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e.success(),t.onload=t.onreadystatechange=null)},t.onerror=function(){e.error(),t.onerror=null},e.appendCall(t)},_.getHostname=function(e,t){t&&"string"==typeof t||(t="hostname解析异常");var r=null;try{r=_.URL(e).hostname}catch(e){sd.log("getHostname传入的url参数不合法！")}return r||t},_.getQueryParamsFromUrl=function(e){var t={},r=e.split("?"),s=r[1]||"";return s&&(t=_.getURLSearchParams("?"+s)),t},_.getURLSearchParams=function(e){e=e||"";for(var t=function e(t){return decodeURIComponent(t)},r={},s=e.substring(1),a=s.split("&"),n=0;n<a.length;n++){var i=a[n].indexOf("=");if(i!==-1){var o=a[n].substring(0,i),d=a[n].substring(i+1);o=t(o),d=t(d),r[o]=d}}return r},_.URL=function(e){var t={},r=["hash","host","hostname","href","origin","password","pathname","port","protocol","search","username"],s=function e(){var t;try{return t=new URL("http://modernizr.com/"),"http://modernizr.com/"===t.href}catch(e){return!1}};if("function"==typeof window.URL&&s())t=new URL(e),t.searchParams||(t.searchParams=function(){var r=_.getURLSearchParams(t.search);return{get:function e(t){return r[t]}}}());else{var a=/^https?:\/\/.+/;if(a.test(e)===!1)throw"Invalid URL";var n=document.createElement("a");n.href=e;for(var i=r.length-1;i>=0;i--){var o=r[i];t[o]=n[o]}t.hostname&&"string"==typeof t.pathname&&0!==t.pathname.indexOf("/")&&(t.pathname="/"+t.pathname),t.searchParams=function(){var r=_.getURLSearchParams(t.search);return{get:function e(t){return r[t]}}}()}return t},_.getCurrentDomain=function(e){var t=sd.para.current_domain;switch(_typeof(t)){case"function":var r=t();return""===r||""===_.trim(r)?"url解析失败":r.indexOf(".")!==-1?r:"url解析失败";case"string":return""===t||""===_.trim(t)?"url解析失败":t.indexOf(".")!==-1?t:"url解析失败";default:var s=_.getCookieTopLevelDomain();return""===e?"url解析失败":""===s?"url解析失败":s}},_.getCookieTopLevelDomain=function(e){e=e||window.location.hostname;var t=e.split(".");if(_.isArray(t)&&t.length>=2&&!/^(\d+\.)+\d+$/.test(e))for(var r="."+t.splice(t.length-1,1);t.length>0;){if(r="."+t.splice(t.length-1,1)+r,document.cookie="sensorsdata_domain_test=true; path=/; domain="+r,document.cookie.indexOf("sensorsdata_domain_test=true")!==-1){var s=new Date;return s.setTime(s.getTime()-1e3),document.cookie="sensorsdata_domain_test=true; expires="+s.toGMTString()+"; path=/; domain="+r,r}}return""},_.isReferralTraffic=function(e){return e=e||document.referrer,""===e||_.getCookieTopLevelDomain(_.getHostname(e))!==_.getCookieTopLevelDomain()},_.ry=function(e){return new _.ry.init(e)},_.ry.init=function(e){this.ele=e},_.ry.init.prototype={addClass:function e(t){var r=" "+this.ele.className+" ";return r.indexOf(" "+t+" ")===-1&&(this.ele.className=this.ele.className+(""===this.ele.className?"":" ")+t),this},removeClass:function e(t){var r=" "+this.ele.className+" ";return r.indexOf(" "+t+" ")!==-1&&(this.ele.className=r.replace(" "+t+" "," ").slice(1,-1)),this},hasClass:function e(t){var r=" "+this.ele.className+" ";return r.indexOf(" "+t+" ")!==-1},attr:function e(t,r){return"string"==typeof t&&_.isUndefined(r)?this.ele.getAttribute(t):("string"==typeof t&&(r=String(r),this.ele.setAttribute(t,r)),this)},offset:function e(){var t=this.ele.getBoundingClientRect();if(t.width||t.height){var r=this.ele.ownerDocument,s=r.documentElement;return{top:t.top+window.pageYOffset-s.clientTop,left:t.left+window.pageXOffset-s.clientLeft}}return{top:0,left:0}},getSize:function e(){if(!window.getComputedStyle)return{width:this.ele.offsetWidth,height:this.ele.offsetHeight};try{var t=this.ele.getBoundingClientRect();return{width:t.width,height:t.height}}catch(e){return{width:0,height:0}}},getStyle:function e(t){return this.ele.currentStyle?this.ele.currentStyle[t]:this.ele.ownerDocument.defaultView.getComputedStyle(this.ele,null).getPropertyValue(t)},wrap:function e(t){var r=document.createElement(t);return this.ele.parentNode.insertBefore(r,this.ele),r.appendChild(this.ele),_.ry(r)},getCssStyle:function e(t){var r=this.ele.style.getPropertyValue(t);if(r)return r;var s=null;if("function"==typeof window.getMatchedCSSRules&&(s=getMatchedCSSRules(this.ele)),!s||!_.isArray(s))return null;for(var a=s.length-1;a>=0;a--){var n=s[a];if(r=n.style.getPropertyValue(t))return r}},sibling:function e(t,r){for(;(t=t[r])&&1!==t.nodeType;){}return t},next:function e(){return this.sibling(this.ele,"nextSibling")},prev:function e(t){return this.sibling(this.ele,"previousSibling")},siblings:function e(t){return this.siblings((this.ele.parentNode||{}).firstChild,this.ele)},children:function e(t){return this.siblings(this.ele.firstChild)},parent:function e(){var t=this.ele.parentNode;return t=t&&11!==t.nodeType?t:null,_.ry(t)}},_.strToUnicode=function(e){if("string"!=typeof e)return sd.log("转换unicode错误",e),e;for(var t="",r=0;r<e.length;r++){t+="\\"+e.charCodeAt(r).toString(16)}return t},_.getReferrer=function(e){var e=e||document.referrer;return"string"!=typeof e?"取值异常_referrer异常_"+String(e):(0===e.indexOf("https://www.baidu.com/")&&(e=e.split("?")[0]),e=e.slice(0,sd.para.max_referrer_string_length),"string"==typeof e?e:"")},_.getKeywordFromReferrer=function(e){e=e||document.referrer;var t=sd.para.source_type.keyword;if(document&&"string"==typeof e){if(0===e.indexOf("http")){var r=_.getReferSearchEngine(e),s=_.getQueryParamsFromUrl(e);if(_.isEmptyObject(s))return"未取到值";var a=null;for(var n in t){if(r===n&&"object"==_typeof(s))if(a=t[n],_.isArray(a))for(var n=0;n<a.length;n++){var i=s[a[n]];if(i)return i}else if(s[a])return s[a]}return"未取到值"}return""===e?"未取到值_直接打开":"未取到值_非http的url"}return"取值异常_referrer异常_"+String(e)},_.getReferSearchEngine=function(e){var t=_.getHostname(e);if(!t||"hostname解析异常"===t)return"";var r=(sd.para.source_type.keyword,{baidu:[/^.*\.baidu\.com$/],bing:[/^.*\.bing\.com$/],google:[/^www\.google\.com$/,/^www\.google\.com\.[a-z]{2}$/,/^www\.google\.[a-z]{2}$/],sm:[/^m\.sm\.cn$/],so:[/^.+\.so\.com$/],sogou:[/^.*\.sogou\.com$/],yahoo:[/^.*\.yahoo\.com$/]});for(var s in r){for(var a=r[s],n=0,i=a.length;n<i;n++){if(a[n].test(t))return s}}return"未知搜索引擎"},_.getSourceFromReferrer=function(){function e(e,t){for(var r=0;r<e.length;r++){if(t.split("?")[0].indexOf(e[r])!==-1)return!0}}var t="("+sd.para.source_type.utm.join("|")+")\\=[^&]+",r=sd.para.source_type.search,s=sd.para.source_type.social,a=document.referrer||"",n=_.info.pageProp.url;if(n){var i=n.match(new RegExp(t));return i&&i[0]?"付费广告流量":e(r,a)?"自然搜索流量":e(s,a)?"社交网站流量":""===a?"直接流量":"引荐流量"}return"获取url异常"},_.info={initPage:function e(){var t=_.getReferrer(),r=location.href,s=_.getCurrentDomain(r);s||sd.debug.jssdkDebug("url_domain异常_"+r+"_"+s),this.pageProp={referrer:t,referrer_host:t?_.getHostname(t):"",url:r,url_host:_.getHostname(r,"url_host取值异常"),url_domain:s}},pageProp:{},campaignParams:function e(){var t=sd.source_channel_standard.split(" "),r="",s={};return _.isArray(sd.para.source_channel)&&sd.para.source_channel.length>0&&(t=t.concat(sd.para.source_channel),t=_.unique(t)),_.each(t,function(e){r=_.getQueryParam(location.href,e),r.length&&(s[e]=r)}),s},campaignParamsStandard:function e(t,r){t=t||"",r=r||"";var s=_.info.campaignParams(),a={},n={};for(var i in s){(" "+sd.source_channel_standard+" ").indexOf(" "+i+" ")!==-1?a[t+i]=s[i]:n[r+i]=s[i]}return{$utms:a,otherUtms:n}},properties:function e(){return{$timezone_offset:(new Date).getTimezoneOffset(),$screen_height:Number(screen.height)||0,$screen_width:Number(screen.width)||0,$lib:"js",$lib_version:String(sd.lib_version)}},currentProps:{},register:function e(t){_.extend(_.info.currentProps,t)}},_.autoExeQueue=function(){var e={items:[],enqueue:function e(t){this.items.push(t),this.start()},dequeue:function e(){return this.items.shift()},getCurrentItem:function e(){return this.items[0]},isRun:!1,start:function e(){this.items.length>0&&!this.isRun&&(this.isRun=!0,this.getCurrentItem().start())},close:function e(){this.dequeue(),this.isRun=!1,this.start()}};return e},_.trackLink=function(e,s,a){function t(e){function t(){r||(r=!0,location.href=n.href)}e.stopPropagation(),e.preventDefault();var r=!1;setTimeout(t,1e3),sd.track(s,a,t)}e=e||{};var n=null;return e.ele&&(n=e.ele),e.event&&(n=e.target?e.target:e.event.target),a=a||{},!(!n||"object"!=_typeof(n))&&(!n.href||/^javascript/.test(n.href)||n.target||n.download||n.onclick?(sd.track(s,a),!1):(e.event&&t(e.event),void(e.ele&&_.addEvent(e.ele,"click",function(e){t(e)}))))},_.eventEmitter=function(){this._events=[],this.pendingEvents=[]},_.eventEmitter.prototype={emit:function e(t){var r=[].slice.call(arguments,1);_.each(this._events,function(e){e.type===t&&e.callback.apply(e.context,r)})},on:function e(t,r,s){"function"==typeof r&&this._events.push({type:t,callback:r,context:s||this})},tempAdd:function e(t,r){r&&t&&(this.pendingEvents.push({type:t,data:r}),this.pendingEvents.length>20?this.pendingEvents.shift():null)},isReady:function e(){var t=this;this.tempAdd=this.emit,0!==this.pendingEvents.length&&(_.each(this.pendingEvents,function(e){t.emit(e.type,e.data)}),this.pendingEvents=[])}},_.rot13obfs=function(e,t){e=String(e),t="number"==typeof t?t:13;for(var r=126,s=e.split(""),a=0,n=s.length;a<n;a++){var i=s[a].charCodeAt(0);i<r&&(s[a]=String.fromCharCode((s[a].charCodeAt(0)+t)%r))}return s.join("")},_.rot13defs=function(e){var t=13,r=126,e=String(e);return _.rot13obfs(e,r-t)}}(),sd.para_default={preset_properties:{latest_utm:!0,latest_traffic_source_type:!0,latest_search_keyword:!0,latest_referrer:!0,latest_referrer_host:!1,latest_landing_page:!1,url:!1,title:!1},img_use_crossorigin:!1,name:"sa",max_referrer_string_length:200,max_string_length:500,cross_subdomain:!0,show_log:!0,is_debug:!1,debug_mode:!1,debug_mode_upload:!1,session_time:0,use_client_time:!1,source_channel:[],send_type:"image",vtrack_ignore:{},auto_init:!0,is_track_single_page:!1,is_single_page:!1,batch_send:!1,source_type:{},callback_timeout:200,datasend_timeout:3e3,queue_timeout:300,is_track_device_id:!1,ignore_oom:!0,app_js_bridge:!1},sd.addReferrerHost=function(e){var t="取值异常";_.isObject(e.properties)&&(e.properties.$first_referrer&&(e.properties.$first_referrer_host=_.getHostname(e.properties.$first_referrer,t)),"track"!==e.type&&"track_signup"!==e.type||("$referrer"in e.properties&&(e.properties.$referrer_host=""===e.properties.$referrer?"":_.getHostname(e.properties.$referrer,t)),sd.para.preset_properties.latest_referrer&&sd.para.preset_properties.latest_referrer_host&&(e.properties.$latest_referrer_host=""===e.properties.$latest_referrer?"":_.getHostname(e.properties.$latest_referrer,t))))},sd.addPropsHook=function(e){sd.para.preset_properties&&sd.para.preset_properties.url&&("track"===e.type||"track_signup"===e.type)&&"undefined"==typeof e.properties.$url&&(e.properties.$url=window.location.href),sd.para.preset_properties&&sd.para.preset_properties.title&&("track"===e.type||"track_signup"===e.type)&&"undefined"==typeof e.properties.$title&&(e.properties.$title=document.title)},sd.initPara=function(e){sd.para=e||sd.para||{};var t={};if(_.isObject(sd.para.is_track_latest))for(var r in sd.para.is_track_latest){t["latest_"+r]=sd.para.is_track_latest[r]}sd.para.preset_properties=_.extend({},sd.para_default.preset_properties,t,sd.para.preset_properties||{});var s;for(s in sd.para_default){void 0===sd.para[s]&&(sd.para[s]=sd.para_default[s])}"string"==typeof sd.para.server_url&&"://"===sd.para.server_url.slice(0,3)&&(sd.para.server_url=location.protocol.slice(-1)+sd.para.server_url),"string"==typeof sd.para.web_url&&"://"===sd.para.web_url.slice(0,3)&&(sd.para.web_url=location.protocol.slice(-1)+sd.para.web_url),"image"!==sd.para.send_type&&"ajax"!==sd.para.send_type&&"beacon"!==sd.para.send_type&&(sd.para.send_type="image"),sd.bridge.initPara(),sd.bridge.initState();var a={datasend_timeout:6e3,send_interval:6e3,one_send_max_length:6};_.localStorage.isSupport()&&_.isSupportCors()&&"object"==(typeof localStorage==="undefined"?"undefined":_typeof(localStorage))?sd.para.batch_send===!0?(sd.para.batch_send=_.extend({},a),sd.para.use_client_time=!0):"object"==_typeof(sd.para.batch_send)&&(sd.para.use_client_time=!0,sd.para.batch_send=_.extend({},a,sd.para.batch_send)):sd.para.batch_send=!1;var n=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],i=["www.baidu.","m.baidu.","m.sm.cn","so.com","sogou.com","youdao.com","google.","yahoo.com/","bing.com/","ask.com/"],o=["weibo.com","renren.com","kaixin001.com","douban.com","qzone.qq.com","zhihu.com","tieba.baidu.com","weixin.qq.com"],d={baidu:["wd","word","kw","keyword"],google:"q",bing:"q",yahoo:"p",sogou:["query","keyword"],so:"q",sm:"q"};if("object"==_typeof(sd.para.source_type)&&(sd.para.source_type.utm=_.isArray(sd.para.source_type.utm)?sd.para.source_type.utm.concat(n):n,sd.para.source_type.search=_.isArray(sd.para.source_type.search)?sd.para.source_type.search.concat(i):i,sd.para.source_type.social=_.isArray(sd.para.source_type.social)?sd.para.source_type.social.concat(o):o,sd.para.source_type.keyword=_.isObject(sd.para.source_type.keyword)?_.extend(d,sd.para.source_type.keyword):d),_.isObject(sd.para.heatmap)&&(sd.para.heatmap.clickmap=sd.para.heatmap.clickmap||"default",sd.para.heatmap.scroll_notice_map=sd.para.heatmap.scroll_notice_map||"default",sd.para.heatmap.scroll_delay_time=sd.para.heatmap.scroll_delay_time||4e3,sd.para.heatmap.scroll_event_duration=sd.para.heatmap.scroll_event_duration||18e3,sd.para.heatmap.renderRefreshTime=sd.para.heatmap.renderRefreshTime||1e3,sd.para.heatmap.loadTimeout=sd.para.heatmap.loadTimeout||1e3),"object"==_typeof(sd.para.server_url)&&sd.para.server_url.length)for(s=0;s<sd.para.server_url.length;s++){/sa\.gif[^\/]*$/.test(sd.para.server_url[s])||(sd.para.server_url[s]=sd.para.server_url[s].replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^\/]+)$/,"/sa.gif$2"))}else/sa\.gif[^\/]*$/.test(sd.para.server_url)||(sd.para.server_url=sd.para.server_url.replace(/\/sa$/,"/sa.gif").replace(/(\/sa)(\?[^\/]+)$/,"/sa.gif$2"));"string"==typeof sd.para.server_url&&(sd.para.debug_mode_url=sd.para.debug_mode_url||sd.para.server_url.replace("sa.gif","debug")),sd.para.noCache===!0?sd.para.noCache="?"+(new Date).getTime():sd.para.noCache="",sd.para.callback_timeout>sd.para.datasend_timeout&&(sd.para.datasend_timeout=sd.para.callback_timeout),sd.para.callback_timeout>sd.para.queue_timeout&&(sd.para.queue_timeout=sd.para.callback_timeout),sd.para.queue_timeout>sd.para.datasend_timeout&&(sd.para.datasend_timeout=sd.para.queue_timeout)},sd.readyState={state:0,historyState:[],stateType:{1:"1-init未开始",2:"2-init开始",3:"3-store完成"},getState:function e(){return this.historyState.join("\n")},setState:function e(t){String(t)in this.stateType&&(this.state=t),this.historyState.push(this.stateType[t])}},sd.setPreConfig=function(e){sd.para=e.para,sd._q=e._q},sd.setInitVar=function(){sd._t=sd._t||1*new Date,sd.lib_version="1.15.13",sd.is_first_visitor=!1,sd.source_channel_standard="utm_source utm_medium utm_campaign utm_content utm_term"},sd.log=function(){if((_.sessionStorage.isSupport()&&"true"===sessionStorage.getItem("sensorsdata_jssdk_debug")||sd.para.show_log)&&(!_.isObject(arguments[0])||sd.para.show_log!==!0&&"string"!==sd.para.show_log&&sd.para.show_log!==!1||(arguments[0]=_.formatJsonString(arguments[0])),"object"==(typeof console==="undefined"?"undefined":_typeof(console))&&console.log))try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}},sd.enableLocalLog=function(){if(_.sessionStorage.isSupport())try{sessionStorage.setItem("sensorsdata_jssdk_debug","true")}catch(e){sd.log("enableLocalLog error: "+e.message)}},sd.disableLocalLog=function(){_.sessionStorage.isSupport()&&sessionStorage.removeItem("sensorsdata_jssdk_debug")},sd.debug={distinct_id:function e(){},jssdkDebug:function e(){},_sendDebug:function e(t){sd.track("_sensorsdata2019_debug",{_jssdk_debug_info:t})},apph5:function e(t){var r="app_h5打通失败-",s={1:r+"use_app_track为false",2:r+"Android或者iOS，没有暴露相应方法",3.1:r+"Android校验server_url失败",3.2:r+"iOS校验server_url失败",4.1:r+"H5 校验 iOS server_url 失败",4.2:r+"H5 校验 Android server_url 失败"},a=t.output,n=t.step,i=t.data||"";"all"!==a&&"console"!==a||sd.log(s[n]),("all"===a||"code"===a)&&_.isObject(sd.para.is_debug)&&sd.para.is_debug.apph5&&(i.type&&"profile"===i.type.slice(0,7)||(i.properties._jssdk_debug_info="apph5-"+String(n)))},defineMode:function e(t){var r={1:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 App SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"},2:{title:"当前页面无法进行可视化全埋点",message:"App SDK 与 Web JS SDK 没有进行打通，请联系贵方技术人员修正 Web JS SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"},3:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 没有开启全埋点配置，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_web_all-1573964.html"},4:{title:"当前页面无法进行可视化全埋点",message:"Web JS SDK 配置的数据校验地址与 App SDK 配置的数据校验地址不一致，请联系贵方工作人员修正 SDK 的配置，详细信息请查看文档。",link_text:"配置文档",link_url:"https://manual.sensorsdata.cn/sa/latest/tech_sdk_client_link-1573913.html"}};return!(!t||!r[t])&&r[t]}};var commonWays={setOnlineState:function e(t){if(t===!0&&_.isObject(sd.para.jsapp)&&"function"==typeof sd.para.jsapp.getData){sd.para.jsapp.isOnline=!0;var r=sd.para.jsapp.getData();_.isArray(r)&&r.length>0&&_.each(r,function(e){_.isJSONString(e)&&sd.sendState.pushSend(JSON.parse(e))})}else sd.para.jsapp.isOnline=!1},autoTrackIsUsed:!1,isReady:function e(t){t()},getUtm:function e(){return _.info.campaignParams()},getStayTime:function e(){return(new Date-sd._t)/1e3},setProfileLocal:function e(t){if(!_.localStorage.isSupport())return sd.setProfile(t),!1;if(!_.isObject(t)||_.isEmptyObject(t))return!1;var r=_.localStorage.parse("sensorsdata_2015_jssdk_profile"),s=!1;if(_.isObject(r)&&!_.isEmptyObject(r)){for(var a in t){!(a in r&&r[a]!==t[a])&&a in r||(r[a]=t[a],s=!0)}s&&(_.localStorage.set("sensorsdata_2015_jssdk_profile",JSON.stringify(r)),sd.setProfile(t))}else _.localStorage.set("sensorsdata_2015_jssdk_profile",JSON.stringify(t)),sd.setProfile(t)},setInitReferrer:function e(){var t=_.getReferrer();sd.setOnceProfile({_init_referrer:t,_init_referrer_host:_.info.pageProp.referrer_host})},setSessionReferrer:function e(){var t=_.getReferrer();store.setSessionPropsOnce({_session_referrer:t,_session_referrer_host:_.info.pageProp.referrer_host})},setDefaultAttr:function e(){_.info.register({_current_url:location.href,_referrer:_.getReferrer(),_referring_host:_.info.pageProp.referrer_host})},trackHeatMap:function e(t,r,s){if("object"==_typeof(t)&&t.tagName){var a=t.tagName.toLowerCase(),n=t.parentNode.tagName.toLowerCase();"button"===a||"a"===a||"a"===n||"button"===n||"input"===a||"textarea"===a||_.hasAttribute(t,"data-sensors-click")||heatmap.start(null,t,a,r,s)}},trackAllHeatMap:function e(t,r,s){if("object"==_typeof(t)&&t.tagName){var a=t.tagName.toLowerCase();heatmap.start(null,t,a,r,s)}},autoTrackSinglePage:function e(t,r){function s(){var e=_.info.campaignParams(),t={};for(var r in e){(" "+sd.source_channel_standard+" ").indexOf(" "+r+" ")!==-1?t["$"+r]=e[r]:t[r]=e[r]}return t}function a(e,t){sd.track("$pageview",_.extend({$referrer:n,$url:location.href,$url_path:location.pathname,$title:document.title},e,s()),t),n=location.href}if(this.autoTrackIsUsed)var n=_.info.pageProp.url;else var n=_.info.pageProp.referrer;t=_.isObject(t)?t:{},t=_.isObject(t)?t:{},sd.is_first_visitor&&!t.not_set_profile&&(sd.setOnceProfile(_.extend({$first_visit_time:new Date,$first_referrer:_.getReferrer(),$first_browser_language:navigator.language||"取值异常",$first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",$first_traffic_source_type:_.getSourceFromReferrer(),$first_search_keyword:_.getKeywordFromReferrer()},s())),sd.is_first_visitor=!1),t.not_set_profile&&delete t.not_set_profile,a(t,r),this.autoTrackSinglePage=a},autoTrackWithoutProfile:function e(t,r){t=_.isObject(t)?t:{},this.autoTrack(_.extend(t,{not_set_profile:!0}),r)},autoTrack:function e(t,r){t=_.isObject(t)?t:{};var s=_.info.campaignParams(),a={};for(var n in s){(" "+sd.source_channel_standard+" ").indexOf(" "+n+" ")!==-1?a["$"+n]=s[n]:a[n]=s[n]}sd.is_first_visitor&&!t.not_set_profile&&(sd.setOnceProfile(_.extend({$first_visit_time:new Date,$first_referrer:_.getReferrer(),$first_browser_language:navigator.language||"取值异常",$first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",$first_traffic_source_type:_.getSourceFromReferrer(),$first_search_keyword:_.getKeywordFromReferrer()},a)),sd.is_first_visitor=!1),t.not_set_profile&&delete t.not_set_profile;var i=location.href;sd.para.is_single_page&&_.addHashEvent(function(){var e=_.getReferrer(i);sd.track("$pageview",_.extend({$referrer:e,$url:location.href,$url_path:location.pathname,$title:document.title},a,t),r),i=location.href}),sd.track("$pageview",_.extend({$referrer:_.getReferrer(),$url:location.href,$url_path:location.pathname,$title:document.title},a,t),r),this.autoTrackIsUsed=!0},getAnonymousID:function e(){return _.isEmptyObject(sd.store._state)?"请先初始化SDK":sd.store._state._first_id||sd.store._state.first_id||sd.store._state._distinct_id||sd.store._state.distinct_id},setPlugin:function e(t){return!!_.isObject(t)&&void _.each(t,function(e,t){_.isFunction(e)&&(_.isObject(window.SensorsDataWebJSSDKPlugin)&&window.SensorsDataWebJSSDKPlugin[t]?e(window.SensorsDataWebJSSDKPlugin[t]):sd.log(t+"没有获取到,请查阅文档，调整"+t+"的引入顺序！"))})},useModulePlugin:function e(){sd.use.apply(sd,arguments)},useAppPlugin:function e(){this.setPlugin.apply(this,arguments)}};sd.quick=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);return"string"==typeof t&&commonWays[t]?commonWays[t].apply(commonWays,r):void("function"==typeof t?t.apply(sd,r):sd.log("quick方法中没有这个功能"+e[0]))},sd.use=function(e,t){_.isObject(sd.modules)&&_.isObject(sd.modules[e])&&_.isFunction(sd.modules[e].init)&&(t=t||{},sd.modules[e].init(sd,t))},sd.track=function(e,t,r){saEvent.check({event:e,properties:t})&&saEvent.send({type:"track",event:e,properties:t},r)},sd.trackLink=function(e,t,r){"object"==_typeof(e)&&e.tagName?_.trackLink({ele:e},t,r):"object"==_typeof(e)&&e.target&&e.event&&_.trackLink(e,t,r)},sd.trackLinks=function(s,a,n){return n=n||{},!(!s||"object"!=_typeof(s))&&!(!s.href||/^javascript/.test(s.href)||s.target)&&void _.addEvent(s,"click",function(e){function t(){r||(r=!0,location.href=s.href)}e.preventDefault();var r=!1;setTimeout(t,1e3),sd.track(a,n,t)})},sd.setProfile=function(e,t){saEvent.check({propertiesMust:e})&&saEvent.send({type:"profile_set",properties:e},t)},sd.setOnceProfile=function(e,t){saEvent.check({propertiesMust:e})&&saEvent.send({type:"profile_set_once",properties:e},t)},sd.appendProfile=function(r,e){saEvent.check({propertiesMust:r})&&(_.each(r,function(e,t){_.isString(e)?r[t]=[e]:_.isArray(e)?r[t]=e:(delete r[t],sd.log("appendProfile属性的值必须是字符串或者数组"))}),_.isEmptyObject(r)||saEvent.send({type:"profile_append",properties:r},e))},sd.incrementProfile=function(e,t){function r(e){for(var t in e){if(!/-*\d+/.test(String(e[t])))return!1}return!0}var s=e;_.isString(e)&&(e={},e[s]=1),saEvent.check({propertiesMust:e})&&(r(e)?saEvent.send({type:"profile_increment",properties:e},t):sd.log("profile_increment的值只能是数字"))},sd.deleteProfile=function(e){saEvent.send({type:"profile_delete"},e),store.set("distinct_id",_.UUID()),store.set("first_id","")},sd.unsetProfile=function(e,t){var r=e,s={};_.isString(e)&&(e=[],e.push(r)),_.isArray(e)?(_.each(e,function(e){_.isString(e)?s[e]=!0:sd.log("profile_unset给的数组里面的值必须时string,已经过滤掉",e)}),saEvent.send({type:"profile_unset",properties:s},t)):sd.log("profile_unset的参数是数组")},sd.identify=function(e,t){"number"==typeof e&&(e=String(e));var r=store.getFirstId();if("undefined"==typeof e){var s=_.UUID();r?store.set("first_id",s):store.set("distinct_id",s)}else saEvent.check({distinct_id:e})?t===!0?r?store.set("first_id",e):store.set("distinct_id",e):r?store.change("first_id",e):store.change("distinct_id",e):sd.log("identify的参数必须是字符串")},sd.trackSignup=function(e,t,r,s){if(saEvent.check({distinct_id:e,event:t,properties:r})){var a=store.getFirstId()||store.getDistinctId();store.set("distinct_id",e),saEvent.send({original_id:a,distinct_id:e,type:"track_signup",event:t,properties:r},s)}},sd.trackAbtest=function(e,t){},sd.registerPage=function(e){saEvent.check({properties:e})?_.extend(_.info.currentProps,e):sd.log("register输入的参数有误")},sd.clearAllRegister=function(e){store.clearAllProps(e)},sd.register=function(e){saEvent.check({properties:e})?store.setProps(e):sd.log("register输入的参数有误")},sd.registerOnce=function(e){saEvent.check({properties:e})?store.setPropsOnce(e):sd.log("registerOnce输入的参数有误")},sd.registerSession=function(e){saEvent.check({properties:e})?store.setSessionProps(e):sd.log("registerSession输入的参数有误")},sd.registerSessionOnce=function(e){saEvent.check({properties:e})?store.setSessionPropsOnce(e):sd.log("registerSessionOnce输入的参数有误")},sd.login=function(e,t){if("number"==typeof e&&(e=String(e)),saEvent.check({distinct_id:e})){var r=store.getFirstId(),s=store.getDistinctId();e!==s?(r||store.set("first_id",s),sd.trackSignup(e,"$SignUp",{},t)):t&&t()}else sd.log("login的参数必须是字符串"),t&&t()},sd.logout=function(e){var t=store.getFirstId();if(t){if(store.set("first_id",""),e===!0){var r=_.UUID();store.set("distinct_id",r)}else store.set("distinct_id",t)}else sd.log("没有first_id，logout失败")},sd.getPresetProperties=function(){function e(){var e=_.info.campaignParams(),t={};for(var r in e){(" "+sd.source_channel_standard+" ").indexOf(" "+r+" ")!==-1?t["$"+r]=e[r]:t[r]=e[r]}return t}var t={$referrer:_.info.pageProp.referrer||"",$referrer_host:_.info.pageProp.referrer?_.getHostname(_.info.pageProp.referrer):"",$url:location.href,$url_path:location.pathname,$title:document.title||"",_distinct_id:store.getDistinctId()},r=_.extend({},_.info.properties(),sd.store.getProps(),e(),t);return sd.para.preset_properties.latest_referrer&&sd.para.preset_properties.latest_referrer_host&&(r.$latest_referrer_host=""===r.$latest_referrer?"":_.getHostname(r.$latest_referrer)),r},sd.detectMode=function(){function e(){sd.readyState.setState(3),window.sensorsdata_app_call_js=function(e){e&&"visualized"==e&&s("undefined"!=typeof sa_jssdk_app_define_mode?!0:!1)},s(!1),sd.bridge.app_js_bridge_v1(),_.info.initPage(),sd.para.is_track_single_page&&_.addSinglePageEvent(function(r){var e=function e(t){t=t||{},r!==location.href&&(_.info.pageProp.referrer=r,sd.quick("autoTrack",_.extend({$url:location.href,$referrer:r},t)))};if("boolean"==typeof sd.para.is_track_single_page)e();else if("function"==typeof sd.para.is_track_single_page){var t=sd.para.is_track_single_page();_.isObject(t)?e(t):t===!0&&e()}}),sd.para.batch_send&&sd.batchSend.batchInterval(),sd.store.init(),sd.readyState.setState(4),sd._q&&_.isArray(sd._q)&&sd._q.length>0&&_.each(sd._q,function(e){sd[e[0]].apply(sd,Array.prototype.slice.call(e[1]))}),_.isObject(sd.para.heatmap)&&(heatmap.initHeatmap(),heatmap.initScrollmap())}var t={searchKeywordMatch:location.search.match(/sa-request-id=([^&#]+)/),isSeachHasKeyword:function e(){var t=this.searchKeywordMatch;return t&&t[0]&&t[1]},hasKeywordHandle:function e(){var t=this.searchKeywordMatch,r=location.search.match(/sa-request-type=([^&#]+)/),s=location.search.match(/sa-request-url=([^&#]+)/);heatmap.setNotice(s),_.sessionStorage.isSupport()&&(s&&s[0]&&s[1]&&sessionStorage.setItem("sensors_heatmap_url",decodeURIComponent(s[1])),sessionStorage.setItem("sensors_heatmap_id",t[1]),r&&r[0]&&r[1]?"1"===r[1]||"2"===r[1]||"3"===r[1]?(r=r[1],sessionStorage.setItem("sensors_heatmap_type",r)):r=null:r=null!==sessionStorage.getItem("sensors_heatmap_type")?sessionStorage.getItem("sensors_heatmap_type"):null),this.isReady(t[1],r)},isReady:function e(t,r,s){sd.para.heatmap_url?_.loadScript({success:function e(){setTimeout(function(){"undefined"!=typeof sa_jssdk_heatmap_render&&(sa_jssdk_heatmap_render(sd,t,r,s),"object"==(typeof console==="undefined"?"undefined":_typeof(console))&&"function"==typeof console.log&&(sd.heatmap_version&&sd.heatmap_version===sd.lib_version||console.log("heatmap.js与sensorsdata.js版本号不一致，可能存在风险!")))},0)},error:function e(){},type:"js",url:sd.para.heatmap_url}):sd.log("没有指定heatmap_url的路径")},isStoregeHasKeyword:function e(){return _.sessionStorage.isSupport()&&"string"==typeof sessionStorage.getItem("sensors_heatmap_id")},storageHasKeywordHandle:function e(){heatmap.setNotice(),t.isReady(sessionStorage.getItem("sensors_heatmap_id"),sessionStorage.getItem("sensors_heatmap_type"),location.href)}},r={isVtrackMode:!1,loadVtrack:function e(){_.loadScript({success:function e(){},error:function e(){},type:"js",url:location.protocol+"//static.sensorsdata.cn/sdk/"+sd.lib_version+"/vtrack.min.js"})},messageListener:function e(t){return"sa-fe"===t.data.source&&void("v-track-mode"===t.data.type&&(t.data.data&&t.data.data.isVtrack&&(r.isVtrackMode=!0,r.loadVtrack()),window.removeEventListener("message",r.messageListener,!1)))},removeMessageHandle:function e(){window.removeEventListener&&window.removeEventListener("message",r.messageListener,!1)},verifyVtrackMode:function e(){window.addEventListener&&window.addEventListener("message",r.messageListener,!1),window.parent&&window.parent.postMessage&&window.parent.postMessage({source:"sa-web-sdk",type:"v-is-vtrack",data:{}},"*")}},s=function e(t){function r(){var e=[];s.touch_app_bridge||e.push(sd.debug.defineMode("1")),_.isObject(sd.para.app_js_bridge)||(e.push(sd.debug.defineMode("2")),s.verify_success=!1),_.isObject(sd.para.heatmap)&&"default"==sd.para.heatmap.clickmap||e.push(sd.debug.defineMode("3")),"fail"===s.verify_success&&e.push(sd.debug.defineMode("4"));var t={callType:"app_alert",data:e};SensorsData_App_Visual_Bridge&&SensorsData_App_Visual_Bridge.sensorsdata_visualized_alert_info?SensorsData_App_Visual_Bridge.sensorsdata_visualized_alert_info(JSON.stringify(t)):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker&&window.webkit.messageHandlers.sensorsdataNativeTracker.postMessage&&window.webkit.messageHandlers.sensorsdataNativeTracker.postMessage(JSON.stringify(t))}var s=sd.bridge.initDefineBridgeInfo();if(_.isObject(window.SensorsData_App_Visual_Bridge)&&window.SensorsData_App_Visual_Bridge.sensorsdata_visualized_mode&&(window.SensorsData_App_Visual_Bridge.sensorsdata_visualized_mode===!0||window.SensorsData_App_Visual_Bridge.sensorsdata_visualized_mode()))if(_.isObject(sd.para.heatmap)&&"default"==sd.para.heatmap.clickmap){if(_.isObject(sd.para.app_js_bridge)&&"success"===s.verify_success){if(t)sa_jssdk_app_define_mode(sd,t);else{var e=location.protocol,a=["http:","https:"];e=_.indexOf(a,e)>-1?e:"https:",_.loadScript({success:function e(){setTimeout(function(){"undefined"!=typeof sa_jssdk_app_define_mode&&sa_jssdk_app_define_mode(sd,t)},0)},error:function e(){},type:"js",url:e+"//static.sensorsdata.cn/sdk/"+sd.lib_version+"/vapph5define.min.js"})}}else r()}else r()};t.isSeachHasKeyword()?t.hasKeywordHandle():window.parent!==self?(r.verifyVtrackMode(),setTimeout(function(){return!r.isVtrackMode&&(r.removeMessageHandle(),void(t.isStoregeHasKeyword()?t.storageHasKeywordHandle():e()))},1e3)):e()},BatchSend.prototype={add:function e(t){_.isObject(t)&&(this.writeStore(t),"track_signup"!==t.type&&"$pageview"!==t.event||this.sendStrategy())},remove:function e(t){this.sendingData>0&&--this.sendingData,_.isArray(t)&&t.length>0&&_.each(t,function(e){_.localStorage.remove(e)})},send:function e(t){var r=this,s=_.isArray(sd.para.server_url)?sd.para.server_url[0]:sd.para.server_url;_.ajax({url:s,type:"POST",data:"data_list="+encodeURIComponent(_.base64Encode(JSON.stringify(t.vals))),credentials:!1,timeout:sd.para.batch_send.datasend_timeout,cors:!0,success:function e(){r.remove(t.keys)},error:function e(){r.sendingData>0&&--r.sendingData}})},sendPrepare:function e(t){var r=t.vals,s=sd.para.batch_send.one_send_max_length,a=r.length;if(a>0)if(a<=s)this.send({keys:t.keys,vals:r});else for(var n=0;n*s<a;n++){this.send({keys:t.keys.splice(0,s),vals:r.splice(0,s)})}},sendStrategy:function e(){var t=this.readStore();t.keys.length>0&&0===this.sendingData&&(this.sendingData=Math.ceil(t.vals.length/sd.para.batch_send.one_send_max_length),this.sendPrepare(t))},batchInterval:function e(){var t=this;setInterval(function(){t.sendStrategy()},sd.para.batch_send.send_interval)},readStore:function e(){for(var t=[],r=[],s=null,a=(new Date).getTime(),n=localStorage.length,i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf("sawebjssdk-")&&/^sawebjssdk\-\d+$/.test(o)&&(s=localStorage.getItem(o),s?(s=_.safeJSONParse(s),s&&_.isObject(s)?(s._flush_time=a,t.push(o),r.push(s)):(localStorage.removeItem(o),sd.log("localStorage-数据parse异常"+s))):(localStorage.removeItem(o),sd.log("localStorage-数据取值异常"+s)))}return{keys:t,vals:r}},writeStore:function e(t){var r=String(Math.random()).slice(2,5)+String(Math.random()).slice(2,5)+String((new Date).getTime()).slice(3);localStorage.setItem("sawebjssdk-"+r,JSON.stringify(t))}},sd.batchSend=new BatchSend;var dataSend={};dataSend.getSendUrl=function(e,t){var r=_.base64Encode(t),s="crc="+_.hashCode(r);return e.indexOf("?")!==-1?e+"&data="+encodeURIComponent(r)+"&ext="+encodeURIComponent(s):e+"?data="+encodeURIComponent(r)+"&ext="+encodeURIComponent(s)},dataSend.getSendData=function(e){var t=_.base64Encode(e),r="crc="+_.hashCode(t);return"data="+encodeURIComponent(t)+"&ext="+encodeURIComponent(r)},dataSend.getInstance=function(e){var t=this.getSendType(e),r=new this[t](e),s=r.start;return r.start=function(){_.isObject(sd.para.is_debug)&&sd.para.is_debug.storage&&sd.store.requests&&sd.store.requests.push({name:this.server_url,initiatorType:this.img?"img":"xmlhttprequest",entryType:"resource",requestData:this.data});var e=this;s.apply(this,arguments),setTimeout(function(){e.isEnd(!0)},sd.para.callback_timeout)},r.end=function(){this.callback&&this.callback();var e=this;setTimeout(function(){e.lastClear&&e.lastClear()},sd.para.datasend_timeout-sd.para.callback_timeout)},r.isEnd=function(e){if(!this.received){this.received=!0,this.end();var t=this;e?sd.para.queue_timeout-sd.para.callback_timeout<=0?t.close():setTimeout(function(){t.close()},sd.para.queue_timeout-sd.para.callback_timeout):t.close()}},r},dataSend.getSendType=function(e){var t=["image","ajax","beacon"],r=t[0];return r=e.config&&_.indexOf(t,e.config.send_type)>-1?e.config.send_type:sd.para.send_type,"beacon"===r&&"function"!=typeof navigator.sendBeacon&&(r="image"),"ajax"===r&&_.isSupportCors()===!1&&(r="image"),r},dataSend.image=function(e){this.callback=e.callback,this.img=document.createElement("img"),this.img.width=1,this.img.height=1,sd.para.img_use_crossorigin&&(this.img.crossOrigin="anonymous"),this.data=e.data,this.server_url=dataSend.getSendUrl(e.server_url,e.data)},dataSend.image.prototype.start=function(){var e=this;sd.para.ignore_oom&&(this.img.onload=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()},this.img.onerror=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()},this.img.onabort=function(){this.onload=null,this.onerror=null,this.onabort=null,e.isEnd()}),this.img.src=this.server_url},dataSend.image.prototype.lastClear=function(){this.img.src=""},dataSend.ajax=function(e){this.callback=e.callback,this.server_url=e.server_url,this.data=dataSend.getSendData(e.data)},dataSend.ajax.prototype.start=function(){var t=this;_.ajax({url:this.server_url,type:"POST",data:this.data,credentials:!1,timeout:sd.para.datasend_timeout,cors:!0,success:function e(){t.isEnd()},error:function e(){t.isEnd()}})},dataSend.beacon=function(e){this.callback=e.callback,this.server_url=dataSend.getSendUrl(e.server_url,e.data),this.data=dataSend.getSendData(e.data)},dataSend.beacon.prototype.start=function(){var e=this;"object"==(typeof navigator==="undefined"?"undefined":_typeof(navigator))&&"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(this.server_url,this.data),setTimeout(function(){e.isEnd()},40)};var sendState={};sd.sendState=sendState,sd.events=new _.eventEmitter,sendState.queue=_.autoExeQueue(),sendState.requestData=null,sendState.getSendCall=function(e,t,r){if(sd.is_heatmap_render_mode)return!1;if(sd.readyState.state<3)return sd.log("初始化没有完成"),!1;e._track_id=Number(String(Math.random()).slice(2,5)+String(Math.random()).slice(2,4)+String((new Date).getTime()).slice(-4)),sd.para.use_client_time&&(e._flush_time=(new Date).getTime());var s=e;return e=JSON.stringify(e),this.requestData={data:s,config:t,callback:r},sd.events.tempAdd("send",s),!sd.para.app_js_bridge&&sd.para.batch_send&&localStorage.length<200?(sd.log(s),sd.batchSend.add(this.requestData.data),!1):(sd.bridge.dataSend(s,this,r),void sd.log(s))},sendState.prepareServerUrl=function(){if("object"==_typeof(this.requestData.config)&&this.requestData.config.server_url)this.sendCall(this.requestData.config.server_url,this.requestData.callback);else if(_.isArray(sd.para.server_url))for(var e=0;e<sd.para.server_url.length;e++){this.sendCall(sd.para.server_url[e])}else sd.para.server_url&&this.sendCall(sd.para.server_url,this.requestData.callback)},sendState.sendCall=function(e,t){var r={server_url:e,data:JSON.stringify(this.requestData.data),callback:t,config:this.requestData.config};_.isObject(sd.para.jsapp)&&!sd.para.jsapp.isOnline&&"function"==typeof sd.para.jsapp.setData?(delete r.callback,r=JSON.stringify(r),sd.para.jsapp.setData(r)):this.pushSend(r)},sendState.pushSend=function(e){var t=dataSend.getInstance(e),r=this;t.close=function(){r.queue.close()},this.queue.enqueue(t)};var saEvent={};sd.saEvent=saEvent,saEvent.checkOption={regChecks:{regName:/^((?!^distinct_id$|^original_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i},checkPropertiesKey:function e(t){var r=this,s=!0;return _.each(t,function(e,t){r.regChecks.regName.test(t)||(s=!1)}),s},check:function e(t,r){return"string"==typeof this[t]?this[this[t]](r):this[t](r)},str:function e(t){return!!_.isString(t)||(sd.log("请检查参数格式,必须是字符串"),!0)},properties:function e(t){return _.strip_sa_properties(t),!t||(_.isObject(t)?!!this.checkPropertiesKey(t)||(sd.log("properties 里的自定义属性名需要是合法的变量名，不能以数字开头，且只包含：大小写字母、数字、下划线，自定义属性不能以 $ 开头"),!0):(sd.log("properties可以没有，但有的话必须是对象"),!0))},propertiesMust:function e(t){return _.strip_sa_properties(t),void 0===t||!_.isObject(t)||_.isEmptyObject(t)?(sd.log("properties必须是对象且有值"),!0):!!this.checkPropertiesKey(t)||(sd.log("properties 里的自定义属性名需要是合法的变量名，不能以数字开头，且只包含：大小写字母、数字、下划线，自定义属性不能以 $ 开头"),!0)},event:function e(t){return!(!_.isString(t)||!this.regChecks.regName.test(t))||(sd.log("请检查参数格式，eventName 必须是字符串，且需是合法的变量名，即不能以数字开头，且只包含：大小写字母、数字、下划线和 $,其中以 $ 开头的表明是系统的保留字段，自定义事件名请不要以 $ 开头"),!0)},test_id:"str",group_id:"str",distinct_id:function e(t){return!(!_.isString(t)||!/^.{1,255}$/.test(t))||(sd.log("distinct_id必须是不能为空，且小于255位的字符串"),!1)}},saEvent.check=function(e){var t=!0;for(var r in e){if(!this.checkOption.check(r,e[r]))return!1}return t},saEvent.send=function(e,t){var r={distinct_id:store.getDistinctId(),lib:{$lib:"js",$lib_method:"code",$lib_version:String(sd.lib_version)},properties:{}};_.isObject(e)&&_.isObject(e.properties)&&!_.isEmptyObject(e.properties)&&e.properties.$lib_detail&&(r.lib.$lib_detail=e.properties.$lib_detail,delete e.properties.$lib_detail),_.extend(r,sd.store.getUnionId(),e),_.isObject(e.properties)&&!_.isEmptyObject(e.properties)&&_.extend(r.properties,e.properties),e.type&&"profile"===e.type.slice(0,7)||(r.properties=_.extend({},_.info.properties(),store.getProps(),store.getSessionProps(),_.info.currentProps,r.properties),sd.para.preset_properties.latest_referrer&&!_.isString(r.properties.$latest_referrer)&&(r.properties.$latest_referrer="取值异常"),sd.para.preset_properties.latest_search_keyword&&!_.isString(r.properties.$latest_search_keyword)&&(r.properties.$latest_search_keyword="取值异常"),sd.para.preset_properties.latest_traffic_source_type&&!_.isString(r.properties.$latest_traffic_source_type)&&(r.properties.$latest_traffic_source_type="取值异常"),sd.para.preset_properties.latest_landing_page&&!_.isString(r.properties.$latest_landing_page)&&(r.properties.$latest_landing_page="取值异常")),r.properties.$time&&_.isDate(r.properties.$time)?(r.time=1*r.properties.$time,delete r.properties.$time):sd.para.use_client_time&&(r.time=1*new Date),_.parseSuperProperties(r.properties),_.filterReservedProperties(r.properties),_.searchObjDate(r),_.searchObjString(r),_.searchZZAppStyle(r);var s=_.searchConfigData(r.properties);saNewUser.checkIsAddSign(r),saNewUser.checkIsFirstTime(r),sd.addReferrerHost(r),sd.addPropsHook(r),sd.para.debug_mode===!0?(sd.log(r),this.debugPath(JSON.stringify(r),t)):sd.sendState.getSendCall(r,s,t)},saEvent.debugPath=function(e,t){var r=e,s="";s=sd.para.debug_mode_url.indexOf("?")!==-1?sd.para.debug_mode_url+"&data="+encodeURIComponent(_.base64Encode(e)):sd.para.debug_mode_url+"?data="+encodeURIComponent(_.base64Encode(e)),_.ajax({url:s,type:"GET",cors:!0,header:{"Dry-Run":String(sd.para.debug_mode_upload)},success:function e(t){_.isEmptyObject(t)===!0?alert("debug数据发送成功"+r):alert("debug失败 错误原因"+JSON.stringify(t))}})};var store=sd.store={requests:[],_sessionState:{},_state:{distinct_id:"",first_id:"",props:{}},getProps:function e(){return this._state.props||{}},getSessionProps:function e(){return this._sessionState},getDistinctId:function e(){return this._state._distinct_id||this._state.distinct_id},getUnionId:function e(){var t={},r=this._state._first_id||this._state.first_id,s=this._state._distinct_id||this._state.distinct_id;return r&&s?(t.login_id=s,t.anonymous_id=r):t.anonymous_id=s,t},getFirstId:function e(){return this._state._first_id||this._state.first_id},toState:function e(t){var r=null;if(null!=t&&_.isJSONString(t)){if(r=JSON.parse(t),this._state=_.extend(r),r.distinct_id){if("object"==_typeof(r.props)){for(var s in r.props){"string"==typeof r.props[s]&&(r.props[s]=r.props[s].slice(0,sd.para.max_referrer_string_length))}this.save()}}else this.set("distinct_id",_.UUID()),sd.debug.distinct_id("1",t)}else this.set("distinct_id",_.UUID()),sd.debug.distinct_id("2",t)},initSessionState:function e(){var t=_.cookie.get("sensorsdata2015session"),r=null;null!==t&&"object"==_typeof(r=JSON.parse(t))&&(this._sessionState=r||{})},setOnce:function e(t,r){t in this._state||this.set(t,r)},set:function e(t,r){this._state=this._state||{},"distinct_id"===t&&this._state.distinct_id&&sd.events.tempAdd("changeDistinctId",r),this._state[t]=r,"first_id"===t?delete this._state._first_id:"distinct_id"===t&&delete this._state._distinct_id,this.save()},change:function e(t,r){this._state["_"+t]=r},setSessionProps:function e(t){var r=this._sessionState;_.extend(r,t),this.sessionSave(r)},setSessionPropsOnce:function e(t){var r=this._sessionState;_.coverExtend(r,t),this.sessionSave(r)},setProps:function e(t,r){var s={};s=r?t:_.extend(this._state.props||{},t);for(var a in s){"string"==typeof s[a]&&(s[a]=s[a].slice(0,sd.para.max_referrer_string_length))}this.set("props",s)},setPropsOnce:function e(t){var r=this._state.props||{};_.coverExtend(r,t),this.set("props",r)},clearAllProps:function e(t){if(this._sessionState={},_.isArray(t)&&t.length>0)for(var r=0;r<t.length;r++){_.isString(t[r])&&t[r].indexOf("latest_")===-1&&t[r]in this._state.props&&delete this._state.props[t[r]]}else for(var r in this._state.props){1!==r.indexOf("latest_")&&delete this._state.props[r]}this.sessionSave({}),this.save()},sessionSave:function e(t){this._sessionState=t,_.cookie.set("sensorsdata2015session",JSON.stringify(this._sessionState),0)},save:function e(){var t=JSON.parse(JSON.stringify(this._state));delete t._first_id,delete t._distinct_id,_.cookie.set(this.getCookieName(),JSON.stringify(t),73e3,sd.para.cross_subdomain)},getCookieName:function e(){var t="";if(sd.para.cross_subdomain===!1){try{t=_.URL(location.href).hostname}catch(e){sd.log(e)}t="string"==typeof t&&""!==t?"sa_jssdk_2015_"+t.replace(/\./g,"_"):"sa_jssdk_2015_root"}else t="sensorsdata2015jssdkcross";return t},init:function e(){this.initSessionState();var t=_.UUID(),r=_.cookie.get(this.getCookieName());null===r?(sd.is_first_visitor=!0,this.set("distinct_id",t)):(_.isJSONString(r)&&JSON.parse(r).distinct_id||(sd.is_first_visitor=!0),this.toState(r)),saNewUser.setDeviceId(t),saNewUser.storeInitCheck(),saNewUser.checkIsFirstLatest()}},saNewUser={checkIsAddSign:function e(t){"track"===t.type&&(_.cookie.getNewUser()?t.properties.$is_first_day=!0:t.properties.$is_first_day=!1)},is_first_visit_time:!1,checkIsFirstTime:function e(t){"track"===t.type&&"$pageview"===t.event&&(this.is_first_visit_time?(t.properties.$is_first_time=!0,this.is_first_visit_time=!1):t.properties.$is_first_time=!1)},setDeviceId:function e(t){var r=null,s=_.cookie.get("sensorsdata2015jssdkcross"),a={};null!=s&&_.isJSONString(s)&&(a=JSON.parse(s),a.$device_id&&(r=a.$device_id)),r=r||t,sd.para.cross_subdomain===!0?store.set("$device_id",r):(a.$device_id=r,_.cookie.set("sensorsdata2015jssdkcross",JSON.stringify(a),null,!0)),sd.para.is_track_device_id&&(_.info.currentProps.$device_id=r)},storeInitCheck:function e(){if(sd.is_first_visitor){var t=new Date,r={h:23-t.getHours(),m:59-t.getMinutes(),s:59-t.getSeconds()};_.cookie.set(_.cookie.getCookieName("new_user"),"1",3600*r.h+60*r.m+r.s+"s"),this.is_first_visit_time=!0}else _.cookie.getNewUser()||(this.checkIsAddSign=function(e){"track"===e.type&&(e.properties.$is_first_day=!1)}),this.checkIsFirstTime=function(e){"track"===e.type&&"$pageview"===e.event&&(e.properties.$is_first_time=!1)}},checkIsFirstLatest:function e(){for(var s=_.info.pageProp.url_domain,t=["$utm_source","$utm_medium","$utm_campaign","$utm_content","$utm_term"],r=store.getProps(),a=0;a<t.length;a++){t[a]in r&&delete r[t[a]]}store.setProps(r,!0);var n={};if(""===s&&(s="url解析失败"),_.each(sd.para.preset_properties,function(e,t){if(t.indexOf("latest_")===-1)return!1;if(t=t.slice(7),e){if("utm"!==t&&"url解析失败"===s)n["$latest_"+t]="url的domain解析失败";else if(_.isReferralTraffic(document.referrer))switch(t){case"traffic_source_type":n.$latest_traffic_source_type=_.getSourceFromReferrer();break;case"referrer":n.$latest_referrer=_.info.pageProp.referrer;break;case"search_keyword":n.$latest_search_keyword=_.getKeywordFromReferrer();break;case"landing_page":n.$latest_landing_page=location.href}}else if("utm"===t&&sd.store._state.props)for(var r in sd.store._state.props){0!==r.indexOf("$latest_utm")&&0!==r.indexOf("_latest_")||delete sd.store._state.props[r]}else sd.store._state.props&&"$latest_"+t in sd.store._state.props&&delete sd.store._state.props["$latest_"+t]}),sd.register(n),sd.para.preset_properties.latest_utm){var i=_.info.campaignParamsStandard("$latest_","_latest_"),o=i.$utms,d=i.otherUtms;_.isEmptyObject(o)||sd.register(o),_.isEmptyObject(d)||sd.register(d)}}};sd.bridge={is_verify_success:!1,initPara:function e(){var t={is_send:!0,white_list:[],is_mui:!1};"object"==_typeof(sd.para.app_js_bridge)?sd.para.app_js_bridge=_.extend({},t,sd.para.app_js_bridge):sd.para.use_app_track===!0||sd.para.app_js_bridge===!0||"only"===sd.para.use_app_track?(sd.para.use_app_track_is_send!==!1&&"only"!==sd.para.use_app_track||(t.is_send=!1),sd.para.app_js_bridge=_.extend({},t)):"mui"===sd.para.use_app_track&&(t.is_mui=!0,sd.para.app_js_bridge=_.extend({},t)),sd.para.app_js_bridge.is_send===!1&&sd.log("设置了 is_send:false,如果打通失败，数据将被丢弃！")},initState:function e(){function t(e){function t(e){var t={hostname:"",project:""};try{t.hostname=_.URL(e).hostname,t.project=_.URL(e).searchParams.get("project")||"default"}catch(e){sd.log(e)}return t}var r=t(e),s=t(sd.para.server_url);if(r.hostname===s.hostname&&r.project===s.project)return!0;if(sd.para.app_js_bridge.white_list.length>0)for(var a=0;a<sd.para.app_js_bridge.white_list.length;a++){var n=t(sd.para.app_js_bridge.white_list[a]);if(n.hostname===r.hostname&&n.project===r.project)return!0}return!1}if(_.isObject(sd.para.app_js_bridge)&&!sd.para.app_js_bridge.is_mui)if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker&&_.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url)t(window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url)&&(sd.bridge.is_verify_success=!0);else if(_.isObject(window.SensorsData_APP_New_H5_Bridge)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_get_server_url&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_track){var r=window.SensorsData_APP_New_H5_Bridge.sensorsdata_get_server_url();r&&t(r)&&(sd.bridge.is_verify_success=!0)}},initDefineBridgeInfo:function e(){var t={touch_app_bridge:!0,verify_success:!1};return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker&&window.webkit.messageHandlers.sensorsdataNativeTracker.postMessage&&_.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url?sd.bridge.is_verify_success?t.verify_success="success":t.verify_success="fail":_.isObject(window.SensorsData_APP_New_H5_Bridge)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_get_server_url&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_track?sd.bridge.is_verify_success?t.verify_success="success":t.verify_success="fail":"object"==(typeof SensorsData_APP_JS_Bridge==="undefined"?"undefined":_typeof(SensorsData_APP_JS_Bridge))&&(SensorsData_APP_JS_Bridge.sensorsdata_verify&&SensorsData_APP_JS_Bridge.sensorsdata_visual_verify||SensorsData_APP_JS_Bridge.sensorsdata_track)?SensorsData_APP_JS_Bridge.sensorsdata_verify&&SensorsData_APP_JS_Bridge.sensorsdata_visual_verify?SensorsData_APP_JS_Bridge.sensorsdata_visual_verify(JSON.stringify({server_url:sd.para.server_url}))?t.verify_success="success":t.verify_success="fail":t.verify_success="success":!/sensors-verify/.test(navigator.userAgent)&&!/sa-sdk-ios/.test(navigator.userAgent)||window.MSStream?t.touch_app_bridge=!1:sd.bridge.iOS_UA_bridge()?t.verify_success="success":t.verify_success="fail",t},iOS_UA_bridge:function e(){if(/sensors-verify/.test(navigator.userAgent)){var t=navigator.userAgent.match(/sensors-verify\/([^\s]+)/);if(t&&t[0]&&"string"==typeof t[1]&&2===t[1].split("?").length){t=t[1].split("?");var r=null,s=null;try{r=_.URL(sd.para.server_url).hostname,s=_.URL(sd.para.server_url).searchParams.get("project")||"default"}catch(e){sd.log(e)}return!(!r||r!==t[0]||!s||s!==t[1])}return!1}return!!/sa-sdk-ios/.test(navigator.userAgent)},dataSend:function e(t,r,s){if(_.isObject(sd.para.app_js_bridge)&&!sd.para.app_js_bridge.is_mui){if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker&&window.webkit.messageHandlers.sensorsdataNativeTracker.postMessage&&_.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url)sd.bridge.is_verify_success?(window.webkit.messageHandlers.sensorsdataNativeTracker.postMessage(JSON.stringify({callType:"app_h5_track",data:_.extend({server_url:sd.para.server_url},t)})),"function"==typeof s&&s()):sd.para.app_js_bridge.is_send?(sd.debug.apph5({data:t,step:"4.1",output:"all"}),r.prepareServerUrl()):"function"==typeof s&&s();else if(_.isObject(window.SensorsData_APP_New_H5_Bridge)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_get_server_url&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_track)sd.bridge.is_verify_success?(SensorsData_APP_New_H5_Bridge.sensorsdata_track(JSON.stringify(_.extend({server_url:sd.para.server_url},t))),"function"==typeof s&&s()):sd.para.app_js_bridge.is_send?(sd.debug.apph5({data:t,step:"4.2",output:"all"}),r.prepareServerUrl()):"function"==typeof s&&s();else if("object"==(typeof SensorsData_APP_JS_Bridge==="undefined"?"undefined":_typeof(SensorsData_APP_JS_Bridge))&&(SensorsData_APP_JS_Bridge.sensorsdata_verify||SensorsData_APP_JS_Bridge.sensorsdata_track))SensorsData_APP_JS_Bridge.sensorsdata_verify?SensorsData_APP_JS_Bridge.sensorsdata_verify(JSON.stringify(_.extend({server_url:sd.para.server_url},t)))?"function"==typeof s&&s():sd.para.app_js_bridge.is_send?(sd.debug.apph5({data:t,step:"3.1",output:"all"}),r.prepareServerUrl()):"function"==typeof s&&s():(SensorsData_APP_JS_Bridge.sensorsdata_track(JSON.stringify(_.extend({server_url:sd.para.server_url},t))),"function"==typeof s&&s());else if(!/sensors-verify/.test(navigator.userAgent)&&!/sa-sdk-ios/.test(navigator.userAgent)||window.MSStream)_.isObject(sd.para.app_js_bridge)&&sd.para.app_js_bridge.is_send===!0?(sd.debug.apph5({data:t,step:"2",output:"all"}),r.prepareServerUrl()):"function"==typeof s&&s();else{var a=null;sd.bridge.iOS_UA_bridge()?(a=document.createElement("iframe"),a.setAttribute("src","sensorsanalytics://trackEvent?event="+encodeURIComponent(JSON.stringify(_.extend({server_url:sd.para.server_url},t)))),document.documentElement.appendChild(a),a.parentNode.removeChild(a),a=null,"function"==typeof s&&s()):sd.para.app_js_bridge.is_send?(sd.debug.apph5({data:t,step:"3.2",output:"all"}),r.prepareServerUrl()):"function"==typeof s&&s()}}else _.isObject(sd.para.app_js_bridge)&&sd.para.app_js_bridge.is_mui?_.isObject(window.plus)&&window.plus.SDAnalytics&&window.plus.SDAnalytics.trackH5Event?(window.plus.SDAnalytics.trackH5Event(data),"function"==typeof s&&s()):_.isObject(sd.para.app_js_bridge)&&sd.para.app_js_bridge.is_send===!0?r.prepareServerUrl():"function"==typeof s&&s():(sd.debug.apph5({data:t,step:"1",output:"code"}),r.prepareServerUrl())},app_js_bridge_v1:function e(){function t(e){a=e,_.isJSONString(a)&&(a=JSON.parse(a)),n&&(n(a),n=null,a=null)}function r(){"object"==_typeof(window.SensorsData_APP_JS_Bridge)&&window.SensorsData_APP_JS_Bridge.sensorsdata_call_app&&(a=SensorsData_APP_JS_Bridge.sensorsdata_call_app(),_.isJSONString(a)&&(a=JSON.parse(a)))}function s(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){var e=document.createElement("iframe");e.setAttribute("src","sensorsanalytics://getAppInfo"),document.documentElement.appendChild(e),e.parentNode.removeChild(e),e=null}}var a=null,n=null;window.sensorsdata_app_js_bridge_call_js=function(e){t(e)},sd.getAppStatus=function(e){return s(),r(),e?void(null===a?n=e:(e(a),a=null)):a}}};var heatmap=sd.heatmap={setNotice:function e(t){sd.is_heatmap_render_mode=!0,sd.para.heatmap||(sd.errorMsg="您SDK没有配置开启点击图，可能没有数据！"),t&&t[0]&&t[1]&&"http:"===t[1].slice(0,5)&&"https:"===location.protocol&&(sd.errorMsg="您的当前页面是https的地址，神策分析环境也必须是https！"),sd.para.heatmap_url||(sd.para.heatmap_url=location.protocol+"//static.sensorsdata.cn/sdk/"+sd.lib_version+"/heatmap.min.js")},getDomIndex:function e(t){if(!t.parentNode)return-1;for(var r=0,s=t.tagName,a=t.parentNode.children,n=0;n<a.length;n++){if(a[n].tagName===s){if(t===a[n])return r;r++}}return-1},selector:function e(t){var r=t.parentNode&&9==t.parentNode.nodeType?-1:this.getDomIndex(t);return t.getAttribute&&t.getAttribute("id")&&(!sd.para.heatmap||sd.para.heatmap&&"not_use_id"!==sd.para.heatmap.element_selector)?"#"+t.getAttribute("id"):t.tagName.toLowerCase()+(~r?":nth-of-type("+(r+1)+")":"")},getDomSelector:function e(t,r){if(!t||!t.parentNode||!t.parentNode.children)return!1;r=r&&r.join?r:[];var s=t.nodeName.toLowerCase();return t&&"body"!==s&&1==t.nodeType?(r.unshift(this.selector(t)),t.getAttribute&&t.getAttribute("id")&&sd.para.heatmap&&"not_use_id"!==sd.para.heatmap.element_selector?r.join(" > "):this.getDomSelector(t.parentNode,r)):(r.unshift("body"),r.join(" > "))},na:function e(){var t=document.documentElement.scrollLeft||window.pageXOffset;return parseInt(isNaN(t)?0:t,10)},i:function e(){var t=0;try{t=o.documentElement&&o.documentElement.scrollTop||m.pageYOffset,t=isNaN(t)?0:t}catch(e){t=0}return parseInt(t,10)},getBrowserWidth:function e(){var t=window.innerWidth||document.body.clientWidth;return isNaN(t)?0:parseInt(t,10)},getBrowserHeight:function e(){var t=window.innerHeight||document.body.clientHeight;return isNaN(t)?0:parseInt(t,10)},getScrollWidth:function e(){var t=parseInt(document.body.scrollWidth,10);return isNaN(t)?0:t},W:function e(t){var r=parseInt(+t.clientX+ +this.na(),10),t=parseInt(+t.clientY+ +this.i(),10);return{x:isNaN(r)?0:r,y:isNaN(t)?0:t}},start:function e(t,r,s,a,n){var i=_.isObject(a)?a:{},o=_.isFunction(n)?n:_.isFunction(a)?a:void 0;if(sd.para.heatmap&&sd.para.heatmap.collect_element&&!sd.para.heatmap.collect_element(r))return!1;var d=this.getDomSelector(r),c=_.getEleInfo({target:r});if(c.$element_selector=d?d:"",sd.para.heatmap&&sd.para.heatmap.custom_property){var u=sd.para.heatmap.custom_property(r);_.isObject(u)&&(c=_.extend(c,u))}c=_.extend(c,i),"a"===s&&sd.para.heatmap&&sd.para.heatmap.isTrackLink===!0?_.trackLink({event:t,target:r},"$WebClick",c):sd.track("$WebClick",c,o)},hasElement:function e(t){var r=t._getPath();if(_.isArray(r)&&r.length>0)for(var s=0;s<r.length;s++){if(r[s]&&r[s].tagName&&"a"===r[s].tagName.toLowerCase())return r[s]}return!1},initScrollmap:function e(){if(!_.isObject(sd.para.heatmap)||"default"!==sd.para.heatmap.scroll_notice_map)return!1;var t=function e(){return!(sd.para.scrollmap&&_.isFunction(sd.para.scrollmap.collect_url)&&!sd.para.scrollmap.collect_url())},r=function r(e){var r={};return r.timeout=e.timeout||1e3,r.func=e.func,r.hasInit=!1,r.inter=null,r.main=function(e,t){this.func(e,t),this.inter=null},r.go=function(e){var t={};this.inter||(t.$viewport_position=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,t.$viewport_position=Math.round(t.$viewport_position)||0,t.$viewport_height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,t.$viewport_width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,e?r.main(t,!0):this.inter=setTimeout(function(){r.main(t)},this.timeout))},r},s=r({timeout:1e3,func:function e(t,r){var s=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop||0,a=new Date,n=a-this.current_time;(n>sd.para.heatmap.scroll_delay_time&&s-t.$viewport_position!==0||r)&&(t.$url=location.href,t.$title=document.title,t.$url_path=location.pathname,t.event_duration=Math.min(sd.para.heatmap.scroll_event_duration,parseInt(n)/1e3),sd.track("$WebStay",t)),this.current_time=a}});s.current_time=new Date,_.addEvent(window,"scroll",function(){return!!t()&&void s.go()}),_.addEvent(window,"unload",function(){return!!t()&&void s.go("notime")})},initHeatmap:function e(){var i=this;return!(!_.isObject(sd.para.heatmap)||"default"!==sd.para.heatmap.clickmap)&&!(_.isFunction(sd.para.heatmap.collect_url)&&!sd.para.heatmap.collect_url())&&("all"===sd.para.heatmap.collect_elements?sd.para.heatmap.collect_elements="all":sd.para.heatmap.collect_elements="interact",void("all"===sd.para.heatmap.collect_elements?_.addEvent(document,"click",function(e){var t=e||window.event;if(!t)return!1;var r=t.target||t.srcElement;if("object"!=_typeof(r))return!1;if("string"!=typeof r.tagName)return!1;var s=r.tagName.toLowerCase();if("body"===s||"html"===s)return!1;if(!r||!r.parentNode||!r.parentNode.children)return!1;var a=r.parentNode.tagName.toLowerCase();"a"===a||"button"===a?i.start(t,r.parentNode,a):i.start(t,r,s)}):_.addEvent(document,"click",function(e){var t=e||window.event;if(!t)return!1;var r=t.target||t.srcElement;if("object"!=_typeof(r))return!1;if("string"!=typeof r.tagName)return!1;var s=r.tagName.toLowerCase();if("body"===s.toLowerCase()||"html"===s.toLowerCase())return!1;if(!r||!r.parentNode||!r.parentNode.children)return!1;var a=r.parentNode;if("a"===s||"button"===s||"input"===s||"textarea"===s||_.hasAttribute(r,"data-sensors-click"))i.start(t,r,s);else if("button"===a.tagName.toLowerCase()||"a"===a.tagName.toLowerCase())i.start(t,a,r.parentNode.tagName.toLowerCase());else if("area"===s&&"map"===a.tagName.toLowerCase()&&_.ry(a).prev().tagName&&"img"===_.ry(a).prev().tagName.toLowerCase())i.start(t,_.ry(a).prev(),_.ry(a).prev().tagName.toLowerCase());else{var n=i.hasElement(e);n&&i.start(t,n,n.tagName.toLowerCase())}})))}};sd.init=function(e){return!(sd.readyState&&sd.readyState.state&&sd.readyState.state>=2)&&(sd.setInitVar(),sd.readyState.setState(2),sd.initPara(e),void sd.detectMode())};var methods=["track","quick","register","registerPage","registerOnce","trackSignup","setProfile","setOnceProfile","appendProfile","incrementProfile","deleteProfile","unsetProfile","identify","login","logout","trackLink","clearAllRegister"];if(_.each(methods,function(e){var t=sd[e];sd[e]=function(){if(sd.readyState.state<3)return _.isArray(sd._q)||(sd._q=[]),sd._q.push([e,arguments]),!1;{if(sd.readyState.getState())return t.apply(sd,arguments);try{console.error("请先初始化神策JS SDK")}catch(e){sd.log(e)}}}}),"string"!=typeof window.sensorsDataAnalytic201505)return"undefined"==typeof window.sensorsDataAnalytic201505?(window.sensorsDataAnalytic201505=sd,sd):window.sensorsDataAnalytic201505;sd.setPreConfig(window[sensorsDataAnalytic201505]),window[sensorsDataAnalytic201505]=sd,window.sensorsDataAnalytic201505=sd}catch(err){if("object"==(typeof console==="undefined"?"undefined":_typeof(console))&&console.log)try{console.log(err)}catch(e){sd.log(e)}}});
//# sourceMappingURL=../../../../__sources__/common/js/libs/sensors/sfaw_1513_6d7debc1.js.map
