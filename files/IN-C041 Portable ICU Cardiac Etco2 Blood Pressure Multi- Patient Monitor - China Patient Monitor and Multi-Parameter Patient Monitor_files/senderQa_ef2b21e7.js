document.domain=/[\w\-]+\.[\w\-]+$/.exec(window.location.hostname)[0];var hisQALoginStatus=false,senderQAInfo=null,resetQAFlag=false;$(function(){var e=$("#loginStatu").val();if(e&&e!=0){hisQALoginStatus=true}initQAFrom();var l=$("#productId").val();var d=$("#freeLogUserName").val();var o=5;var c="";var f=location.host==="www.made-in-china.com";var s=function e(){$(".J-qa-info-list").empty()};var r=function e(n){return $("<div>").text(n).html()};var t=function e(n,i){i=i||0;$(".J-qa-info-list").append('<div class="qa-loading"></div>');var t="/product/question/list";var a=window.croAjax?window.croAjax(t):{url:t,xhrFields:false};$.ajax({url:f?"/showroom/"+d+"/prod-question-list":a.url,cache:false,xhrFields:{withCredentials:a.xhrFields},type:"post",data:{prodId:n,pageNo:i,pageSize:o},success:function e(n){if(n.status===0){c=n.token;var i=n.data.items||[];$(".J-question-count").html(n.data.totalCount);if(i.length){$(".J-qa-info-list").empty();$(".J-qa-info-list").append('<div class="qa-info-title">People who viewed this product askedï¼š</div>');for(var t=0;t<i.length;t++){var a=$('<div class="qa-item J-qa-item" cz-questionId="'+i[t].questionId+'">'+'   <div class="qa-cont">'+'        <div class="qa-q">'+'            <div class="qa-label">'+'                <i class="qa-icon">Q</i>'+"            </div>"+'            <div class="qa-time">'+"                "+i[t].updateTime+""+"            </div>"+'            <div class="qa-area">'+r(i[t].question)+"</div>"+"        </div>"+'        <div class="qa-a">'+'            <div class="qa-label">'+'                <i class="qa-icon">A</i>'+"            </div>"+'            <div class="qa-area">'+r(i[t].answer)+"</div>"+"        </div>"+"    </div>"+'    <div class="qa-helpful">'+'        <span class="helpful-info">Is this answer helpful?</span>'+'        <span class="helpful-radio">'+'            <span class="helpful-item helpful-yes J-helpful" cz-val="0">'+'                <i class="help-ico"></i> Yes'+"            </span>"+'            <span class="helpful-item helpful-no J-helpful" cz-val="1">'+'                <i class="help-ico"></i> No'+"            </span>"+"         </span>"+"    </div>"+"</div>");if(i[t].clickType){a.find('.J-helpful[cz-val="'+i[t].clickType+'"]').addClass("selected")}$(".J-qa-info-list").append(a)}}else{$(".J-qa-info-list").empty();s()}}else if(n.status===1){popToast(n.msg,"err")}else{}},error:function e(){}})};$(".J-qa-info-list").on("click",".J-helpful",function(e){e.preventDefault();var i=$(this);var t=i.parent();var n=i.attr("cz-val");var a=t.attr("cz-count")?parseInt(t.attr("cz-count")):undefined;var o=10;if(!l){return}if(a&&a===o){new artDialog({title:"Notice",content:"Operation too frequent, please try again after 5 minutes.",type:"info",resize:false,lock:true,fixed:true,padding:"30px 20px",okVal:"confirm",ok:function e(){}});return}if(!i.hasClass("selected")){var s="/product/question/helpful";var r=window.croAjax?window.croAjax(s,false):{url:s,xhrFields:false};$.ajax({url:f?"/showroom/"+d+"/prod-question-helpful":r.url,cache:false,type:"post",data:{questionId:i.parents(".J-qa-item").attr("cz-questionid"),helpful:n,_form_uniq_id:c},xhrFields:{withCredentials:r.xhrFields},success:function e(n){if(n.status===0){c=n.token;i.siblings(".J-helpful").removeClass("selected");i.addClass("selected");if(a!==undefined){if(a!==o){t.attr({"cz-count":a+1});if(a+1===o){setTimeout(function(){t.attr({"cz-count":0})},10*60*1e3)}}}else{t.attr({"cz-count":1})}}else if(n.status===1){popToast(n.msg,"err")}else{}},error:function e(){}})}});if($(".J-question-count").length&&l){var n="/product/question/count";var i=window.croAjax?window.croAjax(n,false):{url:n,xhrFields:false};$.ajax({url:f?"/showroom/"+d+"/prod-question-count":i.url,cache:false,type:"post",data:{prodId:l},xhrFields:{withCredentials:i.xhrFields},success:function e(n){if(n.status===0){c=n.token;if(n.data){$(".J-question-count").html(n.data);$(".J-question-count-wp").show();if($(".J-qa-info-list").length&&l){t(l,0);var i=new Pager({index:0,total:Math.ceil(n.data/o),max:10,holder:".J-qa-pager",text:{txt_prev:"Prev",html_prev:"Prev",txt_next:"Next",html_next:"Next",beforeGoto:"Page",afterGoto:""}});i.on("change",function(e){t(l,e.data.index);window.scrollTo(0,$(".J-tabs").offset().top-80)})}}else{$(".J-question-count-wp").hide()}}else if(n.status===1){popToast(n.msg,"err")}else{}},error:function e(){}})}if($("#canSendQaInquiry").length&&$("#canSendQaInquiry").val()==="false"){var a='<div class="J-qa-warnTip qa-wran-top">'+'   <div class="tip arrow-top">'+'       <div class="tip-con">'+'            <p class="tip-para">Sorry, this service is only available for buyers.</p>'+"        </div>"+'       <span class="arrow arrow-out">'+'            <span class="arrow arrow-in"></span>'+"        </span>"+"   </div>"+"</div>";$("#qaContent").attr("disabled",true);$("#qaContent").after(a);$("#qaSend").addClass("btn-disabled");$("#qaSend").attr("disabled",true);$("#qaSend").after(a)}var u=$("#qaContent");var p=function e(n){return n.replace(/[\r\n]+/g,"")};var v=function e(){u.val(p(u.val()))};var h=function e(){setTimeout(function(){v()},0)};var m=function e(n){if(n.which===13||n.keyCode===13){n.preventDefault()}};u.blur(h).bind("paste",h).bind("keydown keyup input",m);var w=function e(){if($("#canSendQaInquiry").val()!=="false"){var n=new Image;n.onload=n.onerror=function(){n=n.onload=n.onerror=null};n.src="//stat.made-in-china.com/event/rec.gif?type=14"}};window.logForQaTab=w});function _resizeQAForm(){var e;if(window.senderInfo){e=$(senderInfo.DOM.content[0]).find("iframe")[0];$(e).css({width:e.contentWindow.document.body.clientWidth,height:e.contentWindow.document.body.clientHeight+20});senderInfo._reset()}if(window.priceDialog){e=$(priceDialog.DOM.content[0]).find("iframe")[0];$(e).css({height:e.contentWindow.document.body.clientHeight+20});window.priceDialog._reset()}if(senderQAInfo){e=$(senderQAInfo.DOM.content[0]).find("iframe")[0];$(e).css({width:e.contentWindow.document.body.clientWidth,height:e.contentWindow.document.body.clientHeight+20});senderQAInfo._reset()}}if(typeof resizeForm==="undefined"){var resizeForm=function e(){setTimeout(_resizeQAForm,25)}}var popToast=function e(n,i,t){n=n||"";i=i||"succ";t=t||2500;var a=$('<div class="alert-new" style="position:fixed;top:40%;left:50%;transform:translateX(-50%);display:none;">'+'    <div class="alert-con alert-disappear '+i+'">'+'        <span class="alert-txt">'+n+"</span>"+"    </div>"+"</div>");$("body").append(a);a.fadeIn(300);setTimeout(function(){a.fadeOut(300,function(){a.remove()})},t)};function initQAFrom(){if($("#qaForm").length){$("#qaForm").bind("submit",function(e){e.preventDefault();if($("#canSendQaInquiry").length&&$("#canSendQaInquiry").val()==="false"){popToast("Sorry, this service is only available for buyers.","warn")}else{if($("#qaForm").valid()){$("#qaSend").addClass("btn-disabled").attr("disabled","disabled");if(senderQAInfo&&!hisQALoginStatus){senderQAInfo.show();var n=$(senderQAInfo.DOM.content[0]).find("iframe")[0].contentWindow;initQADialog(hisQALoginStatus,n,false)}else{senderQAInfoDialog(hisQALoginStatus)}senderQAInfo&&senderQAInfo.lock();senderQAInfo&&senderQAInfo.position("50%","33%")}}});$(".J-his-qa").on("click",function(e){e.preventDefault();e.stopPropagation();var n=$.trim($(this).text());$("#qaContent").val(n);$(".J-his-qa-wp").hide();$("#qaContent").blur();$("#qaContent").focus()});$("#qaContent").on("click",function(){if($.trim($(this).val())===""){$(".J-his-qa-wp").show()}}).on("keydown",function(){$(".J-his-qa-wp").hide()});$("#qaForm, .J-his-qa-wp").on("click",function(e){e.stopPropagation()});$(document).on("click",function(e){e.stopPropagation();$(".J-his-qa-wp").hide()});$("#qaForm").validate({errorWrap:true,rules:{content:{required:true,enonly:true}},messages:{content:{required:"Please enter your question",enonly:"Please enter in English"}}})}}function senderQAInfoDialog(i,t){var e="//www.made-in-china.com/sendInquiry/productQaInquiryForm/";var n="display:none";if($.browser.msie&&parseInt($.browser.version)<=7){n="visibility:hidden;"}senderQAInfo=new art.dialog({fixed:true,show:t?false:true,title:i?"":"Leave your contacts  to recieve timely reply",duration:0,id:"qaDialog",content:'<div class="aui_loading" style="margin:60px auto; width:540px; height:55px; background:url(https://img.made-in-china.com/img/athena/loading-big.gif) no-repeat center center;"></div>'+'<iframe src="'+e+'" frameborder="0" style="'+n+'"></iframe>',init:function e(){var n=this;resetQAFlag=false;$(this.DOM.content[0]).find("iframe").bind("load",function(){initQADialog(i,$(n.DOM.content[0]).find("iframe")[0].contentWindow,t)})},close:function e(){asyncIsLogin(function(e){if(e&&e!==hisQALoginStatus){window.location.reload()}else{$("#qaSend").removeClass("btn-disabled").removeAttr("disabled");if(resetQAFlag){$("#qaContent").val("");senderQAInfo.close();senderQAInfo=null}}});if(!resetQAFlag){senderQAInfo.hide()}}})}function initQADialog(e,i,n){var t=document.forms["qaForm"].content.value;i.loginClickHandle=function(){login&&login("&loginUserName="+mail,function(e){senderQAInfoDialog(e);senderQAInfo&&senderQAInfo.lock();senderQAInfo&&senderQAInfo.position("50%","33%")});senderQAInfo.close();senderQAInfo=null;$("#qaSend").removeClass("btn-disabled").removeAttr("disabled")};i.setForm&&i.setForm({content:t,requestUrl:$("#qaFormshowRoomUrl").val().replace(".html","_2.html")});if(!e){$.ajax({type:"get",url:"//www.made-in-china.com/inquiryabout.do?xcase=getCookieSendEmail",dataType:"jsonp",success:function e(n){if(n&&n.senderMail){i.setForm&&i.setForm({senderMail:n.senderMail})}}})}if(!i.setForm){resetQAFlag=true}if(senderQAInfo&&!e||!i.setForm){$(senderQAInfo.DOM.content[0]).find("iframe").css("visibility","visible");$(senderQAInfo.DOM.content[0]).find("iframe").show();$(senderQAInfo.DOM.content[0]).find(".aui_loading").remove();resizeForm()}var a=function e(n){var i=n.find(".aui_loading:visible");var t=n.find("iframe");var a=i.length>0;var o=t.length<=0||t.filter(":hidden").length>0||t.css("visibility")==="hidden";return a||o};var o=function e(n){var i=n.find(".aui_loading:visible");var t=n.find("iframe");if(i.length){i.remove()}if(t.length){t.css("visibility","visible");t.show()}};if(i){var s=$(senderQAInfo.DOM.content[0]);i.handleFormInvalid=function(){a(s)&&o(s)}}if(e&&!n){i&&i.autoSubmit&&i.autoSubmit()}if(i.result){senderQAInfo.title("")}}
//# sourceMappingURL=../../../__sources__/athena/js/business/senderQa_ef2b21e7.js.map
